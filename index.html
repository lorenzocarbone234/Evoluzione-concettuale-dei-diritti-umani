<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Human Rights Evolution - Final Interactive</title>
    <style>
        :root {
            /* Light Theme Variables */
            --bg-color: #f8fafc;
            --text-color: #2d3748;
            --grid-color: rgba(200, 210, 220, 0.45);
            --axis-color: #2d3748;
            --hist-color: #dd6b20;
            --card-bg: #ffffff;
            --card-border: #cbd5e0;
            --shadow: rgba(0,0,0,0.1);
            
            /* Node Colors */
            --node-conv-bg: #ffffff;
            --node-decl-bg: #fff9c4;
            --node-other-bg: #e2e8f0;
            
            /* Status Colors */
            --status-low: #e53e3e;   /* Red */
            --status-mid: #d69e2e;   /* Yellow */
            --status-high: #38a169;  /* Green */

            /* Branch Colors */
            --c-civil: #e53e3e;        
            --c-econ: #d69e2e;        
            --c-women: #d53f8c;        
            --c-coll: #c05621;        
            --c-social: #3182ce;      
            --c-env: #38a169;         
        }

        /* DARK MODE OVERRIDES */
        body.dark-mode {
            --bg-color: #0f172a;
            --text-color: #f1f5f9;
            --grid-color: rgba(255, 255, 255, 0.08);
            --axis-color: #94a3b8;
            --card-bg: #1e293b;
            --card-border: #475569;
            --shadow: rgba(0,0,0,0.6);
            --node-conv-bg: #334155; 
            --node-decl-bg: #5f5218; 
            --node-other-bg: #475569; 
        }

        /* Base Layout */
        html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background: var(--bg-color); color: var(--text-color); transition: background 0.3s, color 0.3s; }
        
        header { 
            height: 50px; display: flex; align-items: center; justify-content: center; 
            background: var(--card-bg); 
            border-bottom: 1px solid var(--card-border); z-index: 1100; position: relative; 
            backdrop-filter: blur(5px);
        }
        h1 { font-size: 1.2rem; color: var(--text-color); margin: 0; letter-spacing: 0.5px; font-weight: 700; }
        
        /* UI CONTROLS */
        #ui-controls {
            position: fixed; bottom: 20px; right: 20px; z-index: 1100;
            display: flex; flex-direction: column; gap: 10px;
        }
        .ui-btn {
            width: 40px; height: 40px; border-radius: 50%;
            background: var(--card-bg); border: 1px solid var(--card-border);
            color: var(--text-color); font-size: 14px; font-weight: bold; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 10px var(--shadow); transition: transform 0.2s;
        }
        .ui-btn:hover { transform: scale(1.1); }

        /* LEGEND */
        #legend {
            position: fixed; top: 60px; right: 20px; background: var(--card-bg);
            padding: 12px; border-radius: 8px; box-shadow: 0 4px 15px var(--shadow);
            z-index: 1000; font-size: 11px; border: 1px solid var(--card-border); min-width: 200px;
        }
        .legend-section-title { font-size: 10px; font-weight: 800; text-transform: uppercase; color: #94a3b8; margin-bottom: 5px; letter-spacing: 0.5px; }
        .legend-item { display: flex; align-items: center; margin-bottom: 5px; color: var(--text-color); }
        .legend-color { width: 10px; height: 10px; margin-right: 8px; border-radius: 2px; }
        .legend-divider { margin: 8px 0; border-top: 1px solid var(--card-border); }
        .legend-hist-line { width: 14px; border-top: 2px dashed var(--hist-color); margin-right: 8px; }
        .legend-gray-line { width: 14px; border-top: 1px dashed #718096; margin-right: 8px; }
        .legend-square { width: 12px; height: 12px; margin-right: 8px; border: 1px solid #a0aec0; border-radius: 2px; }
        .legend-minor-node { width: 8px; height: 8px; margin-right: 10px; border: 2px solid #4a5568; background: var(--card-bg); border-radius: 2px; margin-left: 2px; }
        .legend-instr { display: flex; flex-direction: column; gap: 6px; color: var(--text-color); font-size: 11px; line-height: 1.4; }
        .legend-instr span { display: flex; align-items: center; }
        .legend-instr i { font-style: normal; margin-right: 10px; font-size: 14px; width: 20px; text-align: center; }
        .legend-instr strong { margin-right: 4px; }

        /* VIEWPORT */
        #viewport { width: 100vw; height: calc(100vh - 50px); overflow-x: scroll; overflow-y: hidden; position: relative; scroll-behavior: smooth; }
        #chart-container {
            position: relative; width: 6800px; height: 650px; 
            margin: 50px 0 60px 0; 
            background-color: var(--bg-color);
            background-image: linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
            background-size: 65px 100%; 
            border-top: 2px solid var(--axis-color); border-bottom: 2px solid var(--axis-color);
            transform-origin: 0 50%; transition: transform 0.3s ease; 
        }
        svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; }

        /* CROSS REFERENCES */
        .cross-ref-line { stroke-dasharray: 4, 4; animation: dash 30s linear infinite; }
        @keyframes dash { to { stroke-dashoffset: 1000; } }

        /* CLOSE BUTTON */
        .close-btn {
            position: absolute; top: 12px; right: 12px; width: 24px; height: 24px;
            display: flex; align-items: center; justify-content: center;
            background: var(--bg-color); border: 1px solid var(--card-border); border-radius: 4px;
            color: #e53e3e; font-weight: bold; font-size: 16px; line-height: 1;
            cursor: pointer; z-index: 2100;
        }
        .close-btn:hover { background: #e53e3e; color: white; border-color: #e53e3e; }

        /* ERAS */
        .era-block { position: absolute; top: 0; bottom: 0; z-index: 0; cursor: pointer; transition: opacity 0.3s; opacity: 0.8; border-left: 1px solid rgba(0,0,0,0.05); }
        .era-block:hover { filter: brightness(0.95); opacity: 1; }
        
        /* ERA LABEL: Reduced size and finer weight */
        .era-label-bg { 
            position: absolute; 
            width: 100%; 
            text-align: center;
            font-size: 2.5rem; /* Reduced from 5rem */
            font-weight: 700;  /* Reduced from 900 */
            text-transform: uppercase; 
            color: rgba(0,0,0,0.06); 
            pointer-events: none; 
            white-space: nowrap; 
            z-index: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
        }
        /* Classi per alternanza */
        .era-pos-top { top: 50px; }
        .era-pos-bot { bottom: 50px; }

        /* PATH HIGHLIGHTING */
        .dimmed { opacity: 0.1 !important; filter: grayscale(100%); transition: opacity 0.4s ease, filter 0.4s ease; }
        path.highlighted-path { stroke-width: 3px !important; opacity: 1 !important; z-index: 10; }
        .node:not(.dimmed) { z-index: 100 !important; }

        /* NODES */
        .node {
            position: absolute; z-index: 20; 
            box-shadow: 0 3px 6px var(--shadow); 
            cursor: pointer; overflow: hidden;
            transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1); 
            display: flex; align-items: center; justify-content: center;
            color: #2d3748; 
        }
        .node.type-main { width: 70px; height: 34px; border-radius: 4px; border-left: 5px solid; border-top: 1px solid #cbd5e0; border-right: 1px solid #cbd5e0; border-bottom: 1px solid #cbd5e0; }
        .node.type-main .sigla { font-weight: 700; font-size: 11px; letter-spacing: 0.3px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; padding: 0 4px; }
        .node.type-main.subtype-conv { background: var(--node-conv-bg); border-bottom: 2px solid #718096; }
        .node.type-main.subtype-decl { background: var(--node-decl-bg); border-bottom: 3px double #d69e2e; border-bottom-color: #a0aec0; }
        .node.type-main.subtype-other { background: var(--node-other-bg); border-bottom: 2px dotted #4a5568; }
        body.dark-mode .node.type-main .sigla { color: var(--text-color); }
        body.dark-mode .node.type-minor { background: var(--card-bg); border-color: var(--text-color); }
        .node.type-minor { width: 14px; height: 14px; border-radius: 3px; border: 2px solid; background: var(--node-conv-bg); padding: 0; }
        .node.type-minor .sigla { display: none; }

        /* EXPANSION LOGIC */
        .node .extended-content { display: none; width: 100%; opacity: 0; transition: opacity 0.2s ease; }
        
        .node.type-main:not(.dimmed):not(.expanded):hover, .node.type-minor:not(.dimmed):not(.expanded):hover {
            transform: scale(1.15); box-shadow: 0 10px 25px var(--shadow); z-index: 50 !important;
        }

        /* CLICK: Full Expansion */
        .node.expanded {
            width: 500px; 
            height: auto; min-height: 200px;
            padding: 20px; z-index: 5000 !important; 
            justify-content: flex-start; align-items: flex-start;
            box-shadow: 0 25px 60px var(--shadow);
            border-radius: 4px; border-width: 1px; border-left-width: 6px; 
            cursor: default; background: var(--card-bg); color: var(--text-color);
        }
        .node.expanded .sigla { display: none; }
        .node.expanded .extended-content { display: block; opacity: 1; }
        .node.type-main.expanded { border-bottom-style: solid; }

        /* CONTENT */
        .extended-content h3 { margin: 0 0 10px 0; font-size: 16px; color: var(--text-color); line-height: 1.3; font-weight: 800; border-bottom: 1px solid var(--card-border); padding-bottom: 8px; }
        .extended-content .info-line { font-size: 11px; font-weight: 800; color: #718096; text-transform: uppercase; margin-bottom: 8px; letter-spacing: 0.5px; }
        .extended-content .description { font-size: 13px; color: var(--text-color); margin-top: 10px; line-height: 1.7; text-align: justify; max-height: 300px; overflow-y: auto; padding-right: 10px; }
        .extended-content .description b { color: #4299e1; font-weight: 700; background: rgba(66, 153, 225, 0.1); padding: 0 2px; border-radius: 2px; }

        .doc-link-btn { display: inline-block; margin-top: 10px; padding: 6px 12px; background: #3182ce; color: white; text-decoration: none; font-size: 11px; font-weight: bold; border-radius: 4px; transition: background 0.2s; }
        .doc-link-btn:hover { background: #2b6cb0; }

        /* RATIFICATION BAR & LIST */
        .ratification-container { margin-top: 15px; font-size: 11px; color: var(--text-color); font-weight: 600; border-top: 1px solid var(--card-border); padding-top: 10px; }
        .progress-track { width: 100%; height: 8px; background: #edf2f7; border-radius: 4px; margin-top: 5px; overflow: hidden; border: 1px solid rgba(0,0,0,0.05); }
        .progress-fill { height: 100%; transition: width 0.5s ease; }
        body.dark-mode .progress-track { background: #4a5568; }

        /* Expandable Country List */
        details { margin-top: 8px; }
        summary { cursor: pointer; color: #718096; font-size: 10px; font-weight: bold; outline: none; }
        summary:hover { color: var(--text-color); }
        .country-list-box {
            margin-top: 5px; max-height: 100px; overflow-y: auto; 
            background: rgba(0,0,0,0.03); border: 1px solid var(--card-border); 
            border-radius: 4px; padding: 5px;
            pointer-events: auto;
        }
        .country-list-box ul { margin: 0; padding: 0; list-style: none; display: flex; flex-wrap: wrap; gap: 4px; }
        .country-list-box li { font-size: 10px; padding: 2px 4px; background: var(--card-bg); border-radius: 2px; border: 1px solid var(--card-border); }

        /* HISTORICAL POP-UP */
        .hist-popover {
            position: absolute; top: 60px; left: 20px; width: 450px; 
            background: var(--card-bg); border: 1px solid var(--hist-color); border-left-width: 5px;
            border-radius: 4px; padding: 24px;
            box-shadow: 0 15px 40px var(--shadow); color: var(--text-color);
            z-index: 2000; display: none; pointer-events: auto;
        }
        .hist-popover.active { display: block; animation: fadeIn 0.3s ease; }
        .hist-popover h4 { margin: 0 0 12px 0; color: #c05621; font-size: 18px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .hist-popover p { margin: 0; font-size: 14px; line-height: 1.8; color: var(--text-color); text-align: justify; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        /* EVENTS & AXIS */
        .bg-event-line { position: absolute; top: 0; width: 1px; height: 100%; border-left: 3px dashed var(--hist-color); z-index: 15; opacity: 0.5; pointer-events: none; transition: opacity 0.4s; }
        .bg-event-label { 
            position: absolute; top: 15px; left: 8px; color: var(--hist-color); font-size: 11px; font-weight: 700; 
            background: var(--card-bg); padding: 4px 8px; border-radius: 4px; box-shadow: 0 2px 4px var(--shadow); white-space: nowrap; cursor: pointer; pointer-events: auto; z-index: 16;
            transition: transform 0.2s;
        }
        .bg-event-label:hover { transform: scale(1.05); }
        .year-guideline { position: absolute; top: 0; bottom: 0; width: 1px; border-left: 1px dashed #718096; opacity: 0.4; z-index: 12; pointer-events: none; }
        .year-guideline-label { position: absolute; left: -15px; width: 30px; text-align: center; font-size: 10px; font-weight: bold; color: var(--text-color); background: var(--card-bg); border-radius: 3px; padding: 2px 0; z-index: 13; box-shadow: 0 1px 2px var(--shadow); }
        .year-guideline-label.top { top: -28px; }
        .year-guideline-label.bot { bottom: -28px; }
        .axis-label { position: absolute; font-size: 11px; font-weight: bold; color: #94a3b8; transform: translateX(-50%); z-index: 15; }
        .axis-top { top: -25px; }
        .axis-bot { bottom: -25px; }
    </style>
</head>
<body>

    <header><h1 id="main-title">Human Rights Timeline: A Comprehensive Evolution</h1></header>

    <div id="ui-controls">
        <button class="ui-btn" onclick="toggleLanguage()" id="lang-btn">EN</button>
        <button class="ui-btn" onclick="toggleTheme()" title="Toggle Dark Mode">üåó</button>
        <button class="ui-btn" onclick="changeZoom(0.1)" title="Zoom In">‚ûï</button>
        <button class="ui-btn" onclick="changeZoom(-0.1)" title="Zoom Out">‚ûñ</button>
    </div>

    <div id="legend">
        <div class="legend-section-title" data-key="branches">Branches</div>
        <div class="legend-item"><div class="legend-color" style="background: var(--c-civil)"></div> <span data-key="civil">Civil & Political</span></div>
        <div class="legend-item"><div class="legend-color" style="background: var(--c-econ)"></div> <span data-key="econ">Economic & Social</span></div>
        <div class="legend-item"><div class="legend-color" style="background: var(--c-women)"></div> <span data-key="women">Gender / Women</span></div>
        <div class="legend-item"><div class="legend-color" style="background: var(--c-coll)"></div> <span data-key="coll">Collective Rights</span></div>
        <div class="legend-item"><div class="legend-color" style="background: var(--c-social)"></div> <span data-key="social">Social Rights</span></div>
        <div class="legend-item"><div class="legend-color" style="background: var(--c-env)"></div> <span data-key="env">Environment</span></div>
        
        <div class="legend-divider"></div>
        <div class="legend-section-title" data-key="types">Document Types</div>
        <div class="legend-item"><div class="legend-square" style="background:var(--node-conv-bg); border-bottom:2px solid #718096;"></div> <span data-key="conv">Convention (Binding)</span></div>
        <div class="legend-item"><div class="legend-square" style="background:var(--node-decl-bg); border-bottom:3px double #d69e2e;"></div> <span data-key="decl">Declaration (Soft Law)</span></div>
        <div class="legend-item"><div class="legend-square" style="background:var(--node-other-bg); border-bottom:2px dotted #4a5568;"></div> <span data-key="other">Other (Rules/Principles)</span></div>
        <div class="legend-item"><div class="legend-minor-node"></div> <span data-key="step">Intermediate Step</span></div>

        <div class="legend-divider"></div>
        <div class="legend-section-title" data-key="elements">Timeline Elements</div>
        <div class="legend-item"><div class="legend-hist-line"></div> <span data-key="event">Historical Event</span></div>
        <div class="legend-item"><div class="legend-gray-line"></div> <span data-key="doc_year">Document Year</span></div>

        <div class="legend-divider"></div>
        <div class="legend-section-title" data-key="explore">How to Explore</div>
        <div class="legend-instr" id="legend-instr-content">
            </div>
    </div>

    <div id="viewport">
        <div id="chart-container">
            <svg id="lines"></svg>
        </div>
    </div>

    <script>
        // --- TRANSLATION DATA ---
        let currentLang = 'en';

        const dict = {
            en: {
                title: "Human Rights Timeline: A Comprehensive Evolution",
                branches: "Branches",
                civil: "Civil & Political",
                econ: "Economic & Social",
                women: "Gender / Women",
                coll: "Collective Rights",
                social: "Social Rights",
                env: "Environment",
                types: "Document Types",
                conv: "Convention (Binding)",
                decl: "Declaration (Soft Law)",
                other: "Other (Rules/Principles)",
                step: "Intermediate Step",
                elements: "Timeline Elements",
                event: "Historical Event",
                doc_year: "Document Year",
                explore: "How to Explore",
                instr: [
                    "<i>üñ±Ô∏è</i> <strong>Scroll</strong> horizontally to navigate history",
                    "<i>üëÜ</i> <strong>Click</strong> Any Node to expand details",
                    "<i>‚ú®</i> <strong>Hover</strong> to see connections",
                    "<i>üåç</i> <strong>Click</strong> Background for Historical Context",
                    "<i>‚ùå</i> <strong>Click</strong> Empty space to Reset view"
                ],
                rat_label: "Ratifications:",
                rat_states: "States",
                view_countries: "View Ratifying Countries",
                read_text: "üìÑ Read Full Text",
                hist_ctx: "Historical Context",
                step_label: "Step"
            },
            it: {
                title: "Evoluzione dei Diritti Umani: Una Cronologia Completa",
                branches: "Rami",
                civil: "Civili & Politici",
                econ: "Economici & Sociali",
                women: "Genere / Donne",
                coll: "Diritti Collettivi",
                social: "Diritti Sociali",
                env: "Ambiente",
                types: "Tipi di Documento",
                conv: "Convenzione (Vincolante)",
                decl: "Dichiarazione (Soft Law)",
                other: "Altro (Regole/Principi)",
                step: "Passaggio Intermedio",
                elements: "Elementi Cronologia",
                event: "Evento Storico",
                doc_year: "Anno Documento",
                explore: "Come Esplorare",
                instr: [
                    "<i>üñ±Ô∏è</i> <strong>Scorri</strong> orizzontalmente per navigare",
                    "<i>üëÜ</i> <strong>Clicca</strong> su un nodo per i dettagli",
                    "<i>‚ú®</i> <strong>Passa sopra</strong> per le connessioni",
                    "<i>üåç</i> <strong>Clicca</strong> lo sfondo per il contesto storico",
                    "<i>‚ùå</i> <strong>Clicca</strong> il vuoto per resettare"
                ],
                rat_label: "Ratifiche:",
                rat_states: "Stati",
                view_countries: "Vedi Paesi Ratificanti",
                read_text: "üìÑ Leggi Testo Completo",
                hist_ctx: "Contesto Storico",
                step_label: "Step"
            }
        };

        const colorMap = { "root": "#2d3748", "branch-civil": "#e53e3e", "branch-econ": "#d69e2e", "branch-women": "#d53f8c", "branch-coll": "#dd6b20", "branch-social": "#3182ce", "branch-env": "#38a169" };

        const data = [
            { "id": "unc", "sigla": "UNC", "type": "main", "year": 1945, "y": 0, "class": "root", 
              "label": { en: "United Nations Charter", it: "Carta delle Nazioni Unite" },
              "desc": { 
                  en: "Signed on June 26, 1945, in San Francisco, the UN Charter is the foundational treaty of modern international law, forged in the aftermath of World War II's devastation and the horrors of the Holocaust. While its primary focus was the maintenance of international peace and security to prevent a third global conflict, Article 1(3) established the 'promotion and encouragement of respect for human rights and for fundamental freedoms' as a core purpose of the UN for the first time in history. However, the Charter did not define what 'human rights' actually were, nor did it create an effective enforcement mechanism. This vagueness was a diplomatic necessity to accommodate the sovereignty concerns of the Great Powers (US, UK, USSR), all of whom feared international scrutiny regarding their own domestic issues, such as racial segregation, colonial rule, and the gulag system. Article 2(7) explicitly prohibited the UN from intervening in matters 'essentially within the domestic jurisdiction of any state', creating a legal tension between sovereignty and rights that persists today.", 
                  it: "Firmata il 26 giugno 1945 a San Francisco, la Carta delle Nazioni Unite √® il trattato fondante del diritto internazionale moderno, forgiato all'indomani della devastazione della Seconda Guerra Mondiale e degli orrori dell'Olocausto. Sebbene il suo obiettivo primario fosse il mantenimento della pace e della sicurezza internazionale per prevenire un terzo conflitto globale, l'Articolo 1(3) stabil√¨ la 'promozione e l'incoraggiamento del rispetto dei diritti umani e delle libert√† fondamentali' come scopo fondamentale dell'ONU per la prima volta nella storia. Tuttavia, la Carta non definiva cosa fossero effettivamente i 'diritti umani', n√© creava un meccanismo di applicazione efficace. Questa vaghezza era una necessit√† diplomatica per accogliere le preoccupazioni sulla sovranit√† delle Grandi Potenze (USA, Regno Unito, URSS), tutte timorose di uno scrutinio internazionale sulle proprie questioni interne, come la segregazione razziale, il dominio coloniale e il sistema dei gulag. L'Articolo 2(7) proibiva esplicitamente all'ONU di intervenire in questioni 'essenzialmente di competenza interna di uno stato', creando una tensione legale tra sovranit√† e diritti che persiste ancora oggi." 
              }, 
              "link": "https://www.un.org/en/about-us/un-charter/full-text", "ratifications": 193, "parent": null },

            { "id": "unchr_comm", "sigla": "UNCHR", "type": "minor", "year": 1946, "y": 0, "class": "root", 
              "label": { en: "UN Commission on Human Rights", it: "Commissione ONU Diritti Umani" },
              "desc": { 
                  en: "Established by the Economic and Social Council (ECOSOC) in 1946, this body was tasked with the monumental job of drafting the 'International Bill of Rights'. Under the visionary and persistent chairmanship of Eleanor Roosevelt, it became the primary political forum for human rights within the UN system. For decades, it was the only international body capable of setting global standards and investigating violations. However, in its later years, it faced severe and justified criticism for 'politicization' and 'selectivity', as serial human rights abusers frequently sought and obtained membership specifically to shield themselves from scrutiny and criticism. This crisis of credibility eventually led to its dissolution and replacement by the Human Rights Council in 2006, marking a significant attempt to reform the UN's human rights machinery.", 
                  it: "Istituita dal Consiglio Economico e Sociale (ECOSOC) nel 1946, questa commissione ebbe il compito monumentale di redigere la 'Carta Internazionale dei Diritti'. Sotto la presidenza visionaria e tenace di Eleanor Roosevelt, divenne il principale forum politico per i diritti umani all'interno del sistema ONU. Per decenni, √® stato l'unico organismo internazionale in grado di stabilire standard globali e indagare sulle violazioni. Tuttavia, nei suoi ultimi anni, affront√≤ critiche severe e giustificate per 'politicizzazione' e 'selettivit√†', poich√© i violatori seriali dei diritti umani cercavano e ottenevano frequentemente l'adesione proprio per proteggersi dallo scrutinio e dalle critiche. Questa crisi di credibilit√† port√≤ infine al suo scioglimento e alla sostituzione con il Consiglio dei Diritti Umani nel 2006, segnando un tentativo significativo di riformare la macchina dei diritti umani dell'ONU." 
              }, 
              "parent": "unc" },

            { "id": "udhr", "sigla": "UDHR", "type": "main", "year": 1948, "y": 0, "class": "root", 
              "label": { en: "Universal Declaration of Human Rights", it: "Dichiarazione Universale Diritti Umani" },
              "desc": { 
                  en: "Adopted on December 10, 1948, at the Palais de Chaillot in Paris via General Assembly Resolution 217A. The UDHR is the cornerstone of the entire human rights protection system and represents the first global expression of rights to which *all* human beings are inherently entitled, regardless of race, color, religion, sex, language, political or other opinion, national or social origin, property, birth or other status. It contains 30 articles covering both civil-political rights (freedom from torture, free speech, fair trial) and economic-social rights (health, education, standard of living). Drafting it was a massive challenge involving diverse philosophical traditions (Western, Chinese, Lebanese, French). Although technically a 'Declaration' and not a binding treaty‚Äîmostly due to the lack of consensus at the time regarding enforcement‚Äîit has arguably gained the status of *Customary International Law*, meaning its core principles are now binding on all states regardless of ratification.", 
                  it: "Adottata il 10 dicembre 1948 al Palais de Chaillot di Parigi con la Risoluzione 217A dell'Assemblea Generale. La DUDU √® la pietra miliare dell'intero sistema di protezione dei diritti umani e rappresenta la prima espressione globale dei diritti a cui *tutti* gli esseri umani hanno titolo inerente, indipendentemente da razza, colore, religione, sesso, lingua, opinione politica o di altro tipo, origine nazionale o sociale, propriet√†, nascita o altro status. Contiene 30 articoli che coprono sia i diritti civili-politici (libert√† dalla tortura, libert√† di parola, giusto processo) sia i diritti economico-sociali (salute, istruzione, tenore di vita). La sua stesura fu una sfida enorme che coinvolse diverse tradizioni filosofiche (occidentale, cinese, libanese, francese). Sebbene tecnicamente sia una 'Dichiarazione' e non un trattato vincolante‚Äîprincipalmente a causa della mancanza di consenso all'epoca sull'applicazione‚Äîha probabilmente acquisito lo status di *Diritto Internazionale Consuetudinario*, il che significa che i suoi principi fondamentali sono ora vincolanti per tutti gli stati, indipendentemente dalla ratifica." 
              }, 
              "link": "https://www.un.org/en/about-us/universal-declaration-of-human-rights", "parent": "unchr_comm" },
            
            { "id": "node_2", "sigla": "DOC", <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Human Rights Evolution - Lorenzo Carbone</title>
    <style>
        :root {
            /* Light Theme Variables */
            --bg-color: #f8fafc;
            --text-color: #2d3748;
            --grid-color: rgba(200, 210, 220, 0.45);
            --axis-color: #2d3748;
            --hist-color: #dd6b20;
            --card-bg: #ffffff;
            --card-border: #cbd5e0;
            --shadow: rgba(0,0,0,0.1);
            
            /* Node Colors */
            --node-conv-bg: #ffffff;
            --node-decl-bg: #fff9c4;
            --node-other-bg: #e2e8f0;
            
            /* Status Colors */
            --status-low: #e53e3e;   /* Red */
            --status-mid: #d69e2e;   /* Yellow */
            --status-high: #38a169;  /* Green */

            /* Branch Colors */
            --c-civil: #e53e3e;        
            --c-econ: #d69e2e;        
            --c-women: #d53f8c;        
            --c-coll: #c05621;        
            --c-social: #3182ce;        
            --c-env: #38a169;            
        }

        /* DARK MODE OVERRIDES */
        body.dark-mode {
            --bg-color: #0f172a;
            --text-color: #f1f5f9;
            --grid-color: rgba(255, 255, 255, 0.08);
            --axis-color: #94a3b8;
            --card-bg: #1e293b;
            --card-border: #475569;
            --shadow: rgba(0,0,0,0.6);
            --node-conv-bg: #334155; 
            --node-decl-bg: #5f5218; 
            --node-other-bg: #475569; 
        }

        /* Base Layout */
        html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background: var(--bg-color); color: var(--text-color); transition: background 0.3s, color 0.3s; }
        
        /* NAVIGATION BAR */
        #main-nav {
            height: 50px; display: flex; align-items: center; justify-content: space-between; padding: 0 20px;
            background: var(--card-bg); border-bottom: 1px solid var(--card-border); z-index: 3000; position: relative;
            box-shadow: 0 2px 10px var(--shadow); font-family: 'Segoe UI', sans-serif; /* Keep Nav Modern */
        }
        .nav-brand { font-weight: 700; font-size: 1.1rem; color: var(--text-color); }
        .nav-links { display: flex; gap: 20px; }
        .nav-item { cursor: pointer; font-weight: 600; font-size: 14px; color: #718096; transition: color 0.2s; text-transform: uppercase; letter-spacing: 0.5px; }
        .nav-item:hover, .nav-item.active { color: var(--c-social); }
        
        /* PAGES GENERAL */
        .page-section { display: none; height: calc(100vh - 50px); width: 100vw; overflow: hidden; position: relative; animation: fadeInPage 0.5s ease; }
        .page-section.active { display: block; }
        @keyframes fadeInPage { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

/* --- BACKGROUND (TINTA UNITA/GRADIENTE) --- */

        #intro-page, #stats-page { 
            position: relative !important;
            z-index: 1; 
            overflow-y: auto; 
            padding: 40px; 
            box-sizing: border-box; 
            height: calc(100vh - 50px); /* Altezza totale meno la navbar */

            /* COLORE AZZURRINO/CELESTE */
            /* Usiamo un gradiente verticale: parte da un celeste chiarissimo e scende verso l'azzurro */
            background: linear-gradient(180deg, #ebf8ff 0%, #bee3f8 100%) !important;
            
            /* Colore del testo forzato a scuro per leggibilit√† */
            color: #2d3748 !important; 
        }

        /* Disabilitiamo vecchi trucchi dell'immagine se rimasti nel codice */
        #intro-page::before, #stats-page::before {
            display: none !important;
        }

        /* --- DARK MODE (Blu Notte Istituzionale) --- */
        /* Quando attivi la modalit√† scura, passa a un blu profondo elegante */
        body.dark-mode #intro-page, 
        body.dark-mode #stats-page {
            background: linear-gradient(180deg, #1a202c 0%, #2b6cb0 100%) !important;
            color: #f7fafc !important;
        }

        /* Contenitore centrale */
        .intro-container, .stats-container {
            max-width: 800px; 
            margin: 0 auto; 
            padding-bottom: 60px;
        }

        /* Assicuriamo che il contenuto sia leggibile */
        .intro-container, .stats-container {
            position: relative;
            z-index: 2; 
            max-width: 800px; 
            margin: 0 auto; 
            padding-bottom: 60px;
        }

        /* Assicuriamo che il contenuto stia sopra l'overlay */
        .intro-container, .stats-container {
            position: relative;
            z-index: 1; 
            max-width: 800px; margin: 0 auto; padding-bottom: 60px;
        }
        
        /* INTRO SPECIFICS */
        .uni-header { text-align: center; border-bottom: 2px solid var(--card-border); padding-bottom: 20px; margin-bottom: 40px; }
        .uni-logo-text { font-size: 1.8rem; font-weight: 700; color: var(--text-color); letter-spacing: 2px; text-transform: uppercase; }
        .uni-sub { font-size: 1.1rem; color: #718096; margin-top: 5px; font-weight: 400; font-style: normal; letter-spacing: 0.5px;}
        
        .project-title { 
            font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            font-size: 3.2rem; 
            font-weight: 700; 
            color: var(--c-social); 
            margin-bottom: 20px; 
            line-height: 1.2; 
            text-align: center; 
            letter-spacing: 2px;
            text-transform: uppercase; 
        }
        .author-box { text-align: center; margin-bottom: 50px; font-size: 1.2rem; color: var(--text-color); border-bottom: 1px solid var(--grid-color); display: inline-block; padding-bottom: 5px; margin-left: 50%; transform: translateX(-50%); letter-spacing: 0.5px;}
        
        .intro-text-block { background: var(--card-bg); padding: 40px; border-radius: 4px; border: 1px solid var(--card-border); box-shadow: 0 5px 15px var(--shadow); margin-bottom: 40px; }
        .intro-text-block h2 { color: var(--c-coll); margin-top: 0; font-size: 1.5rem; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 20px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;}
        .intro-text-block p { line-height: 1.8; font-size: 1.1rem; color: var(--text-color); text-align: justify; margin-bottom: 20px; font-weight: 300; }
        
        .start-btn { display: block; width: 220px; margin: 0 auto; padding: 15px 0; text-align: center; background: var(--c-social); color: white; font-weight: bold; font-size: 1.1rem; border-radius: 4px; cursor: pointer; transition: transform 0.2s, background 0.2s; border: none; box-shadow: 0 4px 15px rgba(49, 130, 206, 0.4); font-family: "Segoe UI", sans-serif; text-transform: uppercase; letter-spacing: 1px; }
        .start-btn:hover { transform: translateY(-2px); background: #2b6cb0; }

        /* UI CONTROLS */
        #ui-controls {
            position: fixed; bottom: 20px; right: 20px; z-index: 1100;
            display: flex; flex-direction: column; gap: 10px;
        }
        .ui-btn {
            width: 40px; height: 40px; border-radius: 50%;
            background: var(--card-bg); border: 1px solid var(--card-border);
            color: var(--text-color); font-size: 14px; font-weight: bold; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 10px var(--shadow); transition: transform 0.2s;
        }
        .ui-btn:hover { transform: scale(1.1); }

        /* LEGEND */
        #legend {
            position: fixed; top: 70px; right: 20px; background: var(--card-bg);
            padding: 0 12px; border-radius: 8px; box-shadow: 0 4px 15px var(--shadow);
            z-index: 1000; font-size: 11px; border: 1px solid var(--card-border); min-width: 200px;
            transition: all 0.3s ease; overflow: hidden; max-height: 600px; 
            font-family: 'Segoe UI', sans-serif;
        }
        
        .legend-header { 
            display: flex; justify-content: space-between; align-items: center; 
            width: 100%; height: 40px; cursor: pointer; 
            font-weight: 800; text-transform: uppercase; color: #94a3b8; letter-spacing: 0.5px;
        }
        .legend-content { padding-bottom: 12px; opacity: 1; transition: opacity 0.3s; }
        .legend-toggle-icon { font-size: 12px; transition: transform 0.3s; margin-left: 10px;}
        
        #legend.collapsed { max-height: 40px; }
        #legend.collapsed .legend-content { opacity: 0; pointer-events: none; }
        #legend.collapsed .legend-toggle-icon { transform: rotate(-90deg); }

        .legend-section-title { font-size: 10px; font-weight: 800; text-transform: uppercase; color: #94a3b8; margin-bottom: 5px; letter-spacing: 0.5px; margin-top: 10px;}
        .legend-item { display: flex; align-items: center; margin-bottom: 5px; color: var(--text-color); }
        .legend-color { width: 10px; height: 10px; margin-right: 8px; border-radius: 2px; }
        .legend-divider { margin: 8px 0; border-top: 1px solid var(--card-border); }
        .legend-hist-line { width: 14px; border-top: 2px dashed var(--hist-color); margin-right: 8px; }
        .legend-gray-line { width: 14px; border-top: 1px dashed #718096; margin-right: 8px; }
        .legend-square { width: 12px; height: 12px; margin-right: 8px; border: 1px solid #a0aec0; border-radius: 2px; }
        .legend-minor-node { width: 8px; height: 8px; margin-right: 10px; border: 2px solid #4a5568; background: var(--card-bg); border-radius: 2px; margin-left: 2px; }
        .legend-instr { display: flex; flex-direction: column; gap: 6px; color: var(--text-color); font-size: 11px; line-height: 1.4; }
        .legend-instr span { display: flex; align-items: center; }
        .legend-instr i { font-style: normal; margin-right: 10px; font-size: 14px; width: 20px; text-align: center; }
        .legend-instr strong { margin-right: 4px; }

        /* VIEWPORT */
        #viewport { width: 100vw; height: 100%; overflow-x: scroll; overflow-y: hidden; position: relative; scroll-behavior: smooth; }
        #chart-container {
            position: relative; width: 6800px; height: 650px; 
            margin: 50px 0 60px 0; 
            background-color: var(--bg-color);
            background-image: linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
            background-size: 65px 100%; 
            border-top: 2px solid var(--axis-color); border-bottom: 2px solid var(--axis-color);
            transform-origin: 0 50%; transition: transform 0.3s ease; 
        }
        svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; }

        /* CROSS REFERENCES */
        .cross-ref-line { stroke-dasharray: 4, 4; animation: dash 30s linear infinite; }
        @keyframes dash { to { stroke-dashoffset: 1000; } }

        /* CLOSE BUTTON */
        .close-btn {
            position: absolute; top: 12px; right: 12px; width: 24px; height: 24px;
            display: flex; align-items: center; justify-content: center;
            background: var(--bg-color); border: 1px solid var(--card-border); border-radius: 4px;
            color: #e53e3e; font-weight: bold; font-size: 16px; line-height: 1;
            cursor: pointer; z-index: 2100;
        }
        .close-btn:hover { background: #e53e3e; color: white; border-color: #e53e3e; }

        /* TOUR CONTROLS */
        #tour-controls {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
            background: var(--card-bg); border: 1px solid var(--card-border);
            padding: 10px 20px; border-radius: 30px;
            display: none; /* Hidden by default */
            align-items: center; gap: 15px;
            box-shadow: 0 10px 25px var(--shadow); z-index: 6000;
        }
        #tour-controls.active { display: flex; animation: slideUp 0.3s ease; }
        .tour-btn {
            padding: 8px 16px; border-radius: 20px; border: none; cursor: pointer;
            font-weight: bold; font-size: 13px; transition: transform 0.2s, background 0.2s;
            background: #e2e8f0; color: #2d3748;
        }
        .tour-btn:hover { transform: scale(1.05); filter: brightness(0.95); }
        .tour-btn.primary { background: #3182ce; color: white; }
        .tour-info { font-size: 12px; font-weight: bold; color: var(--text-color); min-width: 60px; text-align: center; }
        @keyframes slideUp { from { transform: translate(-50%, 20px); opacity: 0; } to { transform: translate(-50%, 0); opacity: 1; } }

        /* ERAS */
        .era-block { position: absolute; top: 0; bottom: 0; z-index: 0; cursor: pointer; transition: opacity 0.3s; opacity: 0.8; border-left: 1px solid rgba(0,0,0,0.05); }
        .era-block:hover { filter: brightness(0.95); opacity: 1; }
        .era-label-bg { 
            position: absolute; width: 100%; text-align: center;
            font-size: 2.5rem; font-weight: 700; text-transform: uppercase; 
            color: rgba(0,0,0,0.06); pointer-events: none; white-space: nowrap; 
            z-index: 0; display: flex; justify-content: center; align-items: center; height: 100px;
        }
        .era-pos-top { top: 50px; }
        .era-pos-bot { bottom: 50px; }

        /* SECRETARY GENERALS - DRAWER STYLE */
        .sg-block {
            position: absolute;
            bottom: 0px; 
            border-top: 3px solid rgba(255,255,255,0.5);
            border-left: 1px solid rgba(0,0,0,0.05);
            border-right: 1px solid rgba(0,0,0,0.05);
            z-index: 100;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            opacity: 0.95;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center; 
            align-items: center;     
            padding: 2px 5px;        
            box-sizing: border-box;
            height: 36px; 
            box-shadow: 0 -2px 5px rgba(0,0,0,0.05);
        }

        .sg-block:hover { 
            filter: brightness(0.92);
            height: 48px; 
            z-index: 101;
        }
        
        .sg-block.expanded-drawer {
            height: 450px !important;
            z-index: 5000 !important;
            box-shadow: 0 -20px 60px rgba(0,0,0,0.3);
            justify-content: flex-start;
            cursor: default;
            border-top: none;
            transform: scale(1.0); 
            background-color: var(--card-bg) !important;
            border-left: 1px solid var(--card-border);
            border-right: 1px solid var(--card-border);
        }

        .sg-label-static {
            font-size: 11px; 
            color: rgba(0,0,0,0.75); 
            font-weight: 700; 
            text-transform: uppercase;
            white-space: nowrap; 
            overflow: hidden; 
            text-overflow: ellipsis;
            pointer-events: none; 
            text-shadow: 0 1px 0 rgba(255,255,255,0.3);
            width: 100%;
            text-align: center;
            letter-spacing: 0.5px; 
            margin-bottom: 0;
        }
        
        .sg-block.expanded-drawer .sg-label-static { display: none; } 

        .sg-content-inner {
            display: none; 
            width: 100%;
            height: 100%;
            padding: 25px; 
            box-sizing: border-box;
            color: var(--text-color); 
            overflow-y: auto;
            text-align: left;
            position: relative;
            animation: fadeIn 0.4s ease 0.2s forwards;
            opacity: 0;
        }
        
        .sg-block.expanded-drawer .sg-content-inner {
            display: block;
            opacity: 1;
        }

        .sg-content-inner h4 {
            margin: 15px 0 20px 0;
            font-size: 1.4rem;
            border-bottom: 1px solid var(--card-border);
            padding-bottom: 10px;
            color: var(--c-coll);
            font-family: 'Segoe UI', sans-serif;
        }
        
        .sg-content-inner p {
            font-size: 1.05rem;
            line-height: 1.7;
            margin-bottom: 20px;
            color: var(--text-color);
            max-width: 800px; 
        }
        
        .sg-close-btn {
            position: absolute; top: 20px; right: 20px;
            width: 32px; height: 32px;
            background: rgba(0,0,0,0.05);
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; font-weight: bold; font-size: 18px;
            transition: all 0.2s;
            color: var(--text-color);
            border: 1px solid var(--card-border);
        }
        .sg-close-btn:hover { background: #e53e3e; color: white; border-color: #e53e3e; transform: rotate(90deg); }

        /* PATH HIGHLIGHTING */
        .dimmed { opacity: 0.1 !important; filter: grayscale(100%); transition: opacity 0.4s ease, filter 0.4s ease; }
        path.highlighted-path { stroke-width: 3px !important; opacity: 1 !important; z-index: 10; }
        .node:not(.dimmed) { z-index: 100 !important; }

        /* NODES */
        .node {
            position: absolute; z-index: 20; 
            box-shadow: 0 3px 6px var(--shadow); 
            cursor: pointer; overflow: hidden;
            transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1); 
            display: flex; align-items: center; justify-content: center;
            color: #2d3748; 
        }
        .node.type-main { width: 70px; height: 34px; border-radius: 4px; border-left: 5px solid; border-top: 1px solid #cbd5e0; border-right: 1px solid #cbd5e0; border-bottom: 1px solid #cbd5e0; }
        .node.type-main .sigla { font-weight: 700; font-size: 11px; letter-spacing: 0.3px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; padding: 0 4px; }
        .node.type-main.subtype-conv { background: var(--node-conv-bg); border-bottom: 2px solid #718096; }
        .node.type-main.subtype-decl { background: var(--node-decl-bg); border-bottom: 3px double #d69e2e; border-bottom-color: #a0aec0; }
        .node.type-main.subtype-other { background: var(--node-other-bg); border-bottom: 2px dotted #4a5568; }
        body.dark-mode .node.type-main .sigla { color: var(--text-color); }
        body.dark-mode .node.type-minor { background: var(--card-bg); border-color: var(--text-color); }
        .node.type-minor { width: 14px; height: 14px; border-radius: 3px; border: 2px solid; background: var(--node-conv-bg); padding: 0; }
        .node.type-minor .sigla { display: none; }

        /* EXPANSION LOGIC */
        .node .extended-content { display: none; width: 100%; opacity: 0; transition: opacity 0.2s ease; }
        .node.type-main:not(.dimmed):not(.expanded):hover, .node.type-minor:not(.dimmed):not(.expanded):hover {
            transform: scale(1.15); box-shadow: 0 10px 25px var(--shadow); z-index: 50 !important;
        }

        /* CLICK: Full Expansion */
        .node.expanded {
            width: 500px; height: auto; min-height: 200px;
            padding: 20px; z-index: 5000 !important; 
            justify-content: flex-start; align-items: flex-start;
            box-shadow: 0 25px 60px var(--shadow);
            border-radius: 4px; border-width: 1px; border-left-width: 6px; 
            cursor: default; background: var(--card-bg); color: var(--text-color);
        }
        .node.expanded .sigla { display: none; }
        .node.expanded .extended-content { display: block; opacity: 1; }
        .node.type-main.expanded { border-bottom-style: solid; }

        /* CONTENT */
        .extended-content h3 { margin: 0 0 10px 0; font-size: 16px; color: var(--text-color); line-height: 1.3; font-weight: 800; border-bottom: 1px solid var(--card-border); padding-bottom: 8px; }
        .extended-content .info-line { font-size: 11px; font-weight: 800; color: #718096; text-transform: uppercase; margin-bottom: 8px; letter-spacing: 0.5px; }
        .extended-content .description { font-size: 13px; color: var(--text-color); margin-top: 10px; line-height: 1.7; text-align: justify; max-height: 300px; overflow-y: auto; padding-right: 10px; }
        .extended-content .description b { color: #4299e1; font-weight: 700; background: rgba(66, 153, 225, 0.1); padding: 0 2px; border-radius: 2px; }

        .doc-link-btn { display: inline-block; margin-top: 10px; padding: 6px 12px; background: #3182ce; color: white; text-decoration: none; font-size: 11px; font-weight: bold; border-radius: 4px; transition: background 0.2s; }
        .doc-link-btn:hover { background: #2b6cb0; }

        /* RATIFICATION BAR & LIST */
        .ratification-container { margin-top: 15px; font-size: 11px; color: var(--text-color); font-weight: 600; border-top: 1px solid var(--card-border); padding-top: 10px; }
        .progress-track { width: 100%; height: 8px; background: #edf2f7; border-radius: 4px; margin-top: 5px; overflow: hidden; border: 1px solid rgba(0,0,0,0.05); }
        .progress-fill { height: 100%; transition: width 0.5s ease; }
        body.dark-mode .progress-track { background: #4a5568; }

        /* Expandable Country List */
        details { margin-top: 8px; }
        summary { cursor: pointer; color: #718096; font-size: 10px; font-weight: bold; outline: none; }
        summary:hover { color: var(--text-color); }
        .country-list-box {
            margin-top: 5px; max-height: 100px; overflow-y: auto; 
            background: rgba(0,0,0,0.03); border: 1px solid var(--card-border); 
            border-radius: 4px; padding: 5px; pointer-events: auto;
        }
        .country-list-box ul { margin: 0; padding: 0; list-style: none; display: flex; flex-wrap: wrap; gap: 4px; }
        .country-list-box li { font-size: 10px; padding: 2px 4px; background: var(--card-bg); border-radius: 2px; border: 1px solid var(--card-border); }

        /* HISTORICAL POP-UP */
        .hist-popover {
            position: absolute; top: 60px; left: 20px; width: 450px; 
            background: var(--card-bg); border: 1px solid var(--hist-color); border-left-width: 5px;
            border-radius: 4px; padding: 24px;
            box-shadow: 0 15px 40px var(--shadow); color: var(--text-color);
            z-index: 2000; display: none; pointer-events: auto; font-family: 'Segoe UI', sans-serif;
        }
        .hist-popover.active { display: block; animation: fadeIn 0.3s ease; }
        .hist-popover h4 { margin: 0 0 12px 0; color: #c05621; font-size: 18px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .hist-popover p { margin: 0; font-size: 14px; line-height: 1.8; color: var(--text-color); text-align: justify; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        /* EVENTS & AXIS */
        .bg-event-line { position: absolute; top: 0; width: 1px; height: 100%; border-left: 3px dashed var(--hist-color); z-index: 15; opacity: 0.5; pointer-events: none; transition: opacity 0.4s; }
        .bg-event-label { 
            position: absolute; top: 15px; left: 8px; color: var(--hist-color); font-size: 11px; font-weight: 700; 
            background: var(--card-bg); padding: 4px 8px; border-radius: 4px; box-shadow: 0 2px 4px var(--shadow); white-space: nowrap; cursor: pointer; pointer-events: auto; z-index: 16;
            transition: transform 0.2s;
        }
        .bg-event-label:hover { transform: scale(1.05); }
        .year-guideline { position: absolute; top: 0; bottom: 0; width: 1px; border-left: 1px dashed #718096; opacity: 0.4; z-index: 12; pointer-events: none; }
        .year-guideline-label { position: absolute; left: -15px; width: 30px; text-align: center; font-size: 10px; font-weight: bold; color: var(--text-color); background: var(--card-bg); border-radius: 3px; padding: 2px 0; z-index: 13; box-shadow: 0 1px 2px var(--shadow); }
        .year-guideline-label.top { top: -28px; }
        .year-guideline-label.bot { bottom: -28px; }
        .axis-label { position: absolute; font-size: 11px; font-weight: bold; color: #94a3b8; transform: translateX(-50%); z-index: 15; }
        .axis-top { top: -25px; }
        .axis-bot { bottom: -25px; }
        
        /* TUTORIAL ONBOARDING STYLES */
        #tutorial-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 9000; display: none; pointer-events: none; 
        }
        
        .spotlight-mask {
            position: absolute;
            box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.75); 
            border-radius: 4px;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            pointer-events: none;
            z-index: 9001;
            border: 2px solid #ed8936;
        }

        .tutorial-card {
            position: absolute;
            width: 300px;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            z-index: 9002;
            transition: all 0.4s ease;
            pointer-events: auto; 
        }

        .tut-header { font-weight: 800; font-size: 1.1rem; color: var(--c-social); margin-bottom: 10px; }
        .tut-text { font-size: 0.95rem; color: var(--text-color); line-height: 1.5; margin-bottom: 20px; }
        
        .tut-footer { display: flex; justify-content: space-between; align-items: center; }
        .tut-skip { background: transparent; border: none; color: #718096; cursor: pointer; font-size: 0.9rem; text-decoration: underline; }
        .tut-next { background: var(--c-social); color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-weight: bold; }
        .tut-next:hover { background: #2b6cb0; }
        
        /* SEARCH BAR STYLE */
        .search-wrapper {
            position: relative;
            margin-right: 15px;
            display: flex;
            align-items: center;
        }

        #search-input {
            padding: 8px 10px 8px 30px; 
            border-radius: 20px;
            border: 1px solid var(--card-border);
            background: var(--bg-color);
            color: var(--text-color);
            font-size: 13px;
            width: 140px;
            transition: all 0.3s ease;
            outline: none;
            font-family: inherit;
        }

        #search-input:focus {
            width: 220px; 
            border-color: var(--c-social);
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.2);
        }

        .search-icon {
            position: absolute;
            left: 10px;
            font-size: 12px;
            color: #718096;
            pointer-events: none;
        }

        /* STATS PAGE STYLES */
        .stats-container {
            max-width: 1000px;
            margin: 0 auto;
            text-align: center;
        }

        .stats-title {
            font-family: 'Segoe UI', sans-serif;
            font-size: 2.5rem;
            color: var(--c-social);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .stats-subtitle {
            font-size: 1.1rem;
            color: #718096;
            margin-bottom: 50px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; 
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 800px) {
            .stats-grid { grid-template-columns: 1fr; } 
        }

        .stat-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 4px 15px var(--shadow);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .stat-card h3 {
            margin-top: 0;
            color: var(--text-color);
            font-size: 1.1rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid var(--grid-color);
            padding-bottom: 10px;
            width: 100%;
            margin-bottom: 20px;
        }

        .chart-wrapper {
            position: relative;
            height: 300px;
            width: 100%;
        }

        .stat-desc {
            margin-top: 20px;
            font-size: 0.9rem;
            color: #718096;
            font-style: italic;
            line-height: 1.5;
        }
    </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

    <nav id="main-nav">
        <div class="nav-brand">HumanRightsTimeline</div>
        <div class="nav-links">
            <div class="search-wrapper">
                <span class="search-icon">üîç</span>
                <input type="text" id="search-input" placeholder="Search..." onkeyup="runSearch()">
            </div>

            <div class="nav-item active" onclick="switchPage('intro')" id="nav-intro">Introduction</div>
            <div class="nav-item" onclick="switchPage('timeline')" id="nav-timeline">Timeline</div>
            <div class="nav-item" onclick="switchPage('stats')" id="nav-stats">Analytics</div>
            
            <div class="nav-item" onclick="toggleTheme()" title="Toggle Dark Mode">üåó</div>
            <div class="nav-item" onclick="toggleLanguage()" id="lang-btn">EN</div>
        </div>
    </nav>

    <div id="intro-page" class="page-section active">
        <div class="intro-container">
            <div class="uni-header">
                <div class="uni-logo-text">Universit√† degli Studi di Milano</div>
                <div class="uni-sub" id="intro-uni-sub-1">Corso di Laurea Magistrale in Scienze Storiche</div>
                <div class="uni-sub" id="intro-uni-sub-2">Corso di Digital Humanities della Prof.ssa Simona Turbanti</div>
            </div>

            <h1 class="project-title" id="intro-main-title">Human Rights Evolution</h1>
            <div class="author-box"><span id="intro-author-prefix">Elaborato di</span> <strong>Lorenzo Carbone</strong></div>

            <div class="intro-text-block">
                <h2 id="intro-title-1">About the Project</h2>
                <p id="intro-text-1">
                    </p>
                <br>
                <p id="intro-text-2">
                    </p>
            </div>

            <button class="start-btn" onclick="switchPage('timeline')" id="intro-btn">Go to Timeline ‚Üí</button>
        </div>
    </div>

    <div id="timeline-page" class="page-section">
        <div id="ui-controls">
            <button class="ui-btn" onclick="startUITutorial(true)" title="Help / Tutorial">?</button>
            
            <button class="ui-btn" onclick="startTour()" title="Guided Tour" id="tour-launch-btn">üéì</button>
            <button class="ui-btn" onclick="changeZoom(0.1)" title="Zoom In">‚ûï</button>
            <button class="ui-btn" onclick="changeZoom(-0.1)" title="Zoom Out">‚ûñ</button>
        </div>

        <div id="tour-controls">
            <button class="tour-btn" onclick="prevStep()" id="tour-prev">‚Üê Prev</button>
            <div class="tour-info"><span id="tour-current">1</span> / <span id="tour-total">12</span></div>
            <button class="tour-btn primary" onclick="nextStep()" id="tour-next">Next ‚Üí</button>
            <button class="tour-btn" onclick="endTour()" id="tour-exit">Exit</button>
        </div>

        <div id="legend">
            <div class="legend-header" onclick="toggleLegend()">
                <div class="legend-section-title" id="legend-title-text" style="margin:0;">Legend</div>
                <div class="legend-toggle-icon">‚ñº</div>
            </div>
            
            <div class="legend-content">
                <div class="legend-section-title" data-key="branches">Branches</div>
                <div class="legend-item"><div class="legend-color" style="background: var(--c-civil)"></div> <span data-key="civil">Civil & Political</span></div>
                <div class="legend-item"><div class="legend-color" style="background: var(--c-econ)"></div> <span data-key="econ">Economic & Social</span></div>
                <div class="legend-item"><div class="legend-color" style="background: var(--c-women)"></div> <span data-key="women">Gender / Women</span></div>
                <div class="legend-item"><div class="legend-color" style="background: var(--c-coll)"></div> <span data-key="coll">Collective Rights</span></div>
                <div class="legend-item"><div class="legend-color" style="background: var(--c-social)"></div> <span data-key="social">Social Rights</span></div>
                <div class="legend-item"><div class="legend-color" style="background: var(--c-env)"></div> <span data-key="env">Environment</span></div>
                
                <div class="legend-divider"></div>
                <div class="legend-section-title" data-key="types">Document Types</div>
                <div class="legend-item"><div class="legend-square" style="background:var(--node-conv-bg); border-bottom:2px solid #718096;"></div> <span data-key="conv">Convention (Binding)</span></div>
                <div class="legend-item"><div class="legend-square" style="background:var(--node-decl-bg); border-bottom:3px double #d69e2e;"></div> <span data-key="decl">Declaration (Soft Law)</span></div>
                <div class="legend-item"><div class="legend-square" style="background:var(--node-other-bg); border-bottom:2px dotted #4a5568;"></div> <span data-key="other">Other (Rules/Principles)</span></div>
                <div class="legend-item"><div class="legend-minor-node"></div> <span data-key="step">Intermediate Step</span></div>

                <div class="legend-divider"></div>
                <div class="legend-section-title" data-key="elements">Timeline Elements</div>
                <div class="legend-item"><div class="legend-hist-line"></div> <span data-key="event">Historical Event</span></div>
                <div class="legend-item"><div class="legend-color" style="background: #a0aec0; height:4px;"></div> <span data-key="sg_legend">UN Secretary General</span></div>

                <div class="legend-divider"></div>
                <div class="legend-section-title" data-key="explore">How to Explore</div>
                <div class="legend-instr" id="legend-instr-content">
                </div>
            </div>
        </div>

        <div id="viewport">
            <div id="chart-container">
                <svg id="lines"></svg>
            </div>
        </div>
    </div>
    <div id="tutorial-overlay">
        <div class="spotlight-mask" id="tut-spotlight"></div>
        <div class="tutorial-card" id="tut-card">
            <div class="tut-header" id="tut-title">Title</div>
            <div class="tut-text" id="tut-desc">Description</div>
            <div class="tut-footer">
                <button class="tut-skip" onclick="endUITutorial(true)">Skip</button>
                <div style="font-size:12px; color:#aaa;"><span id="tut-step-curr">1</span>/<span id="tut-step-tot">5</span></div>
                <button class="tut-next" onclick="nextUITutorialStep()" id="tut-btn-next">Next ‚Üí</button>
            </div>
        </div>
    </div>
<div id="stats-page" class="page-section">
        <div class="stats-container">
            <h1 class="stats-title" id="stat-main-title">Data Analysis</h1>
            <p class="stats-subtitle" id="stat-main-sub">Quantitative breakdown of the Human Rights evolution (1945-2022)</p>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="stat-card1-title">Distribution by Rights Branch</h3>
                    <div class="chart-wrapper">
                        <canvas id="chart-branches"></canvas>
                    </div>
                    <div class="stat-desc" id="stat-card1-desc">
                        Shows the thematic focus of international law. Note the shift from purely Civil rights to specialized thematic rights.
                    </div>
                </div>

                <div class="stat-card">
                    <h3 id="stat-card2-title">Documents Adopted per Decade</h3>
                    <div class="chart-wrapper">
                        <canvas id="chart-decades"></canvas>
                    </div>
                    <div class="stat-desc" id="stat-card2-desc">
                        Highlights periods of intense normative activity, specifically post-Cold War (1990s).
                    </div>
                </div>
            </div>
            
            <button class="start-btn" onclick="switchPage('timeline')" style="margin-top:40px; width:200px;" id="stat-back-btn">Back to Timeline</button>
        </div>
    </div>
    <script>
        // --- TRANSLATION DATA ---
        let currentLang = 'en';

        const dict = {
            en: {
                uni_sub_1: "Master's Degree in Historical Sciences",
                uni_sub_2: "Digital Humanities Course - Prof. Simona Turbanti",
                project_title: "Human Rights Evolution",
                author_prefix: "Project by",
                intro_title: "About the Project",
                intro_text_1: "This project presents a multi-level temporal visualization of the normative evolution of human rights from 1945 to the present day. It was developed to analyze how international law has expanded from the initial abstract declarations of the post-war period to complex, binding treaty systems that cover specific groups (women, children, persons with disabilities) and new challenges (environment, technology).",
                intro_text_2: "The visualization allows users to explore the connections between historical events, the tenure of UN Secretary-Generals, and the adoption of key legal instruments. By visualizing the 'branches' of rights (Civil, Social, Collective), we can observe how the definition of what constitutes a 'human right' has been continuously renegotiated and expanded over decades.",
                timeline_btn: "Go to Timeline ‚Üí",
                nav_stats: "Analytics",
                stat_title: "Data Analysis",
                stat_sub: "Quantitative breakdown of the Human Rights evolution (1945-2022)",
                stat_c1_title: "Distribution by Rights Branch",
                stat_c1_desc: "Shows the thematic focus of international law. Note the shift from purely Civil rights to specialized thematic rights.",
                stat_c2_title: "Documents Adopted per Decade",
                stat_c2_desc: "Highlights periods of intense normative activity, specifically post-Cold War (1990s).",
                stat_back: "Back to Timeline",
                chart_label_docs: "Documents Adopted",
                nav_intro: "Introduction",
                nav_timeline: "Timeline",
                legend_title: "Legend",
                branches: "Branches",
                civil: "Civil & Political",
                econ: "Economic & Social",
                women: "Gender / Women",
                coll: "Collective Rights",
                social: "Social Rights",
                env: "Environment",
                types: "Document Types",
                conv: "Convention (Binding)",
                decl: "Declaration (Soft Law)",
                other: "Other (Rules/Principles)",
                step: "Intermediate Step",
                elements: "Timeline Elements",
                event: "Historical Event",
                sg_legend: "UN Secretary General",
                doc_year: "Document Year",
                explore: "How to Explore",
                instr: [
                    "<i>üñ±Ô∏è</i> <strong>Scroll</strong> horizontally to navigate history",
                    "<i>üëÜ</i> <strong>Click</strong> Any Node to expand details",
                    "<i>‚ú®</i> <strong>Hover</strong> to see connections",
                    "<i>üåç</i> <strong>Click</strong> Background for Historical Context",
                    "<i>ü§µ</i> <strong>Click</strong> Bars at bottom for Secretary Generals",
                    "<i>‚ùå</i> <strong>Click</strong> Empty space to Reset view"
                ],
                rat_label: "Ratifications:",
                rat_states: "States",
                view_countries: "View Ratifying Countries",
                read_text: "üìÑ Read Full Text",
                hist_ctx: "Historical Context",
                step_label: "Step",
                tour_prev: "‚Üê Prev",
                tour_next: "Next ‚Üí",
                tour_exit: "Exit"
            },
            it: {
                uni_sub_1: "Corso di Laurea Magistrale in Scienze Storiche",
                uni_sub_2: "Corso di Digital Humanities della Prof.ssa Simona Turbanti",
                project_title: "Evoluzione dei Diritti Umani",
                author_prefix: "Elaborato di",
                intro_title: "Il Progetto",
                intro_text_1: "Questo progetto presenta una visualizzazione temporale multilivello dell'evoluzione normativa dei diritti umani dal 1945 a oggi. √à stato sviluppato per analizzare come il diritto internazionale si sia espanso dalle iniziali dichiarazioni astratte del dopoguerra a complessi sistemi di trattati vincolanti che coprono gruppi specifici (donne, bambini, persone con disabilit√†) e nuove sfide (ambiente, tecnologia).",
                intro_text_2: "La visualizzazione consente agli utenti di esplorare le connessioni tra eventi storici, il mandato dei Segretari Generali dell'ONU e l'adozione di strumenti legali chiave. Visualizzando i 'rami' dei diritti (Civili, Sociali, Collettivi), possiamo osservare come la definizione di ci√≤ che costituisce un 'diritto umano' sia stata continuamente rinegoziata ed ampliata nel corso dei decenni.",
                timeline_btn: "Vai alla Timeline ‚Üí",
                // --- NUOVE TRADUZIONI PER STATISTICHE ---
                nav_stats: "Analisi Dati",
                stat_title: "Analisi Dati",
                stat_sub: "Ripartizione quantitativa dell'evoluzione dei diritti umani (1945-2022)",
                stat_c1_title: "Distribuzione per Ramo",
                stat_c1_desc: "Mostra il focus tematico del diritto internazionale. Nota il passaggio dai diritti puramente civili a diritti tematici specializzati.",
                stat_c2_title: "Documenti Adottati per Decennio",
                stat_c2_desc: "Evidenzia i periodi di intensa attivit√† normativa, in particolare dopo la Guerra Fredda (anni '90).",
                stat_back: "Torna alla Timeline",
                chart_label_docs: "Documenti Adottati",
                // ----------------------------------------
                nav_intro: "Introduzione",
                nav_timeline: "Timeline",
                legend_title: "Legenda",
                branches: "Rami",
                civil: "Civili & Politici",
                econ: "Economici & Sociali",
                women: "Genere / Donne",
                coll: "Diritti Collettivi",
                social: "Diritti Sociali",
                env: "Ambiente",
                types: "Tipi di Documento",
                conv: "Convenzione (Vincolante)",
                decl: "Dichiarazione (Soft Law)",
                other: "Altro (Regole/Principi)",
                step: "Passaggio Intermedio",
                elements: "Elementi Cronologia",
                event: "Evento Storico",
                sg_legend: "Segretario Generale ONU",
                doc_year: "Anno Documento",
                explore: "Come Esplorare",
                instr: [
                    "<i>üñ±Ô∏è</i> <strong>Scorri</strong> orizzontalmente per navigare",
                    "<i>üëÜ</i> <strong>Clicca</strong> su un nodo per i dettagli",
                    "<i>‚ú®</i> <strong>Passa sopra</strong> per le connessioni",
                    "<i>üåç</i> <strong>Clicca</strong> lo sfondo per il contesto storico",
                    "<i>ü§µ</i> <strong>Clicca</strong> le barre in basso per i Segretari Generali",
                    "<i>‚ùå</i> <strong>Clicca</strong> il vuoto per resettare"
                ],
                rat_label: "Ratifiche:",
                rat_states: "Stati",
                view_countries: "Vedi Paesi Ratificanti",
                read_text: "üìÑ Leggi Testo Completo",
                hist_ctx: "Contesto Storico",
                step_label: "Step",
                tour_prev: "‚Üê Prec",
                tour_next: "Avanti ‚Üí",
                tour_exit: "Esci"
            }
        };

        const colorMap = { "root": "#2d3748", "branch-civil": "#e53e3e", "branch-econ": "#d69e2e", "branch-women": "#d53f8c", "branch-coll": "#dd6b20", "branch-social": "#3182ce", "branch-env": "#38a169" };

        const data = [
            { "id": "unc", "sigla": "UNC", "type": "main", "year": 1945, "y": 0, "class": "root", 
              "label": { en: "Charter of the United Nations", it: "Carta delle Nazioni Unite" },
              "desc": { 
                  en: "Signed on June 26, 1945, in San Francisco, the UN Charter is the foundational treaty of modern international law. Born from the ashes of World War II, it represented a paradigm shift: for the first time, how a state treated its own citizens became a matter of international concern, limiting absolute state sovereignty. Article 1(3) explicitly established the 'promotion and encouragement of respect for human rights' as a core purpose of the UN, alongside peace and security. Although it did not define these rights in detail, it provided the constitutional basis for all subsequent human rights architecture.", 
                  it: "Firmata il 26 giugno 1945 a San Francisco, la Carta delle Nazioni Unite √® il trattato fondante del diritto internazionale moderno. Nata dalle ceneri della Seconda Guerra Mondiale, rappresent√≤ un cambio di paradigma: per la prima volta, il modo in cui uno stato trattava i propri cittadini divenne una questione di interesse internazionale, limitando la sovranit√† statale assoluta. L'Articolo 1(3) stabil√¨ esplicitamente la 'promozione e l'incoraggiamento del rispetto dei diritti umani' come scopo fondamentale dell'ONU, accanto alla pace e alla sicurezza. Sebbene non definisse questi diritti nel dettaglio, forn√¨ la base costituzionale per tutta la successiva architettura dei diritti umani." 
              }, 
              "link": "https://www.un.org/en/about-us/un-charter/full-text", "ratifications": 193, "parent": null },

            { "id": "unchr_comm", "sigla": "UNCHR", "type": "minor", "year": 1946, "y": 0, "class": "root", 
              "label": { en: "UN Commission on Human Rights", it: "Commissione ONU per i Diritti Umani" },
              "desc": { 
                  en: "Established by ECOSOC in 1946, this body was tasked with the monumental job of drafting the 'International Bill of Rights'. Under the chairmanship of Eleanor Roosevelt, it became the primary political forum for human rights within the UN system. For decades, it was the central hub where states negotiated norms, although it was later criticized for politicization and allowing human rights violators to shield themselves from scrutiny. It laid the groundwork for the UDHR and the 1966 Covenants before being replaced by the Human Rights Council in 2006.", 
                  it: "Istituita dall'ECOSOC nel 1946, questa commissione ebbe il monumentale compito di redigere la 'Carta Internazionale dei Diritti'. Sotto la presidenza di Eleanor Roosevelt, divenne il principale forum politico per i diritti umani nel sistema ONU. Per decenni √® stata il fulcro centrale dove gli stati negoziavano le norme, sebbene sia stata successivamente criticata per la politicizzazione e per aver permesso ai violatori dei diritti umani di proteggersi dallo scrutinio. Ha gettato le basi per la DUDU e i Patti del 1966 prima di essere sostituita dal Consiglio per i Diritti Umani nel 2006." 
              }, 
              "parent": "unc" },

            { "id": "udhr", "sigla": "UDHR", "type": "main", "year": 1948, "y": 0, "class": "root", 
              "label": { en: "Universal Declaration of Human Rights", it: "Dichiarazione Universale dei Diritti Umani" },
              "desc": { 
                  en: "Adopted on December 10, 1948, the UDHR is the cornerstone of human rights protection. It represents the first global expression of rights to which *all* human beings are inherently entitled, regardless of race, color, religion, sex, language, political opinion, national or social origin, property, birth or other status. Containing 30 articles, it covers both civil/political rights (like free speech and fair trial) and economic/social rights (like health and education). While originally a non-binding declaration, many of its provisions have achieved the status of customary international law, becoming binding on all states.", 
                  it: "Adottata il 10 dicembre 1948, la DUDU √® la pietra miliare della protezione dei diritti umani. Rappresenta la prima espressione globale dei diritti a cui *tutti* gli esseri umani hanno titolo intrinsecamente, indipendentemente da razza, colore, religione, sesso, lingua, opinione politica, origine nazionale o sociale, ricchezza, nascita o altro status. Contenente 30 articoli, copre sia i diritti civili/politici (come la libert√† di parola e il giusto processo) sia i diritti economici/sociali (come la salute e l'istruzione). Sebbene originariamente fosse una dichiarazione non vincolante, molte delle sue disposizioni hanno raggiunto lo status di diritto internazionale consuetudinario." 
              }, 
              "link": "https://www.un.org/en/about-us/universal-declaration-of-human-rights", "parent": "unchr_comm" },
            
            { "id": "node_2", "sigla": "DOC", "type": "main", "year": 1960, "y": 135, "class": "branch-coll", 
              "label": { en: "Declaration on the Granting of Independence to Colonial Countries", it: "Dichiarazione sull'Indipendenza ai Paesi Coloniali" },
              "desc": { en: "Known as the 'Magna Carta of Decolonization', this historic declaration fundamentally shifted the UN's stance on colonialism. It asserted that the subjection of peoples to alien subjugation, domination, and exploitation constitutes a denial of fundamental human rights, is contrary to the Charter, and is an impediment to the promotion of world peace and cooperation. It firmly established that inadequacy of political, economic, social or educational preparedness should never serve as a pretext for delaying independence.", it: "Conosciuta come la 'Magna Carta della Decolonizzazione', questa storica dichiarazione cambi√≤ radicalmente la posizione dell'ONU sul colonialismo. Afferm√≤ che la sottomissione dei popoli al dominio e allo sfruttamento straniero costituisce una negazione dei diritti umani fondamentali, √® contraria alla Carta ed √® un impedimento alla promozione della pace mondiale. Stabil√¨ fermamente che l'inadeguatezza della preparazione politica, economica o sociale non deve mai servire come pretesto per ritardare l'indipendenza." }, 
              "related": ["unc"], "parent": "udhr" },
            
            { "id": "A_RES_1514(XV)", "sigla": "Res. 1514", "type": "minor", "year": 1960, "y": 135, "class": "branch-coll", 
              "label": { en: "General Assembly Resolution 1514 (XV)", it: "Risoluzione 1514 (XV)" },
              "desc": { en: "This resolution internationalized the issue of colonialism, transforming 'Self-Determination' from a political principle into a legal right. It provided the legal leverage for liberation movements across Africa and Asia to demand immediate sovereignty. It challenged the old European imperial order by declaring that all peoples have an inalienable right to complete freedom, the exercise of their sovereignty, and the integrity of their national territory.", it: "Questa risoluzione internazionalizz√≤ la questione del colonialismo, trasformando l'Autodeterminazione da principio politico a diritto legale. Forn√¨ la leva giuridica per i movimenti di liberazione in Africa e Asia per richiedere sovranit√† immediata. Sfid√≤ il vecchio ordine imperiale europeo dichiarando che tutti i popoli hanno un diritto inalienabile alla completa libert√†, all'esercizio della sovranit√† e all'integrit√† del territorio nazionale." }, 
              "parent": "node_2" },
            
            { "id": "node_27", "sigla": "Res. 1803", "type": "minor", "year": 1962, "y": -45, "class": "branch-econ", 
              "label": { en: "Resolution on Permanent Sovereignty over Natural Resources", it: "Risoluzione sulla Sovranit√† Permanente sulle Risorse Naturali" },
              "desc": { en: "Passed during the height of decolonization, this resolution declared that the right of peoples and nations to permanent sovereignty over their natural wealth and resources must be exercised in the interest of their national development and of the well-being of the people of the State concerned. It was a crucial step for economic independence, preventing former colonial powers from maintaining economic control through unfavorable concessions.", it: "Approvata durante l'apice della decolonizzazione, questa risoluzione dichiar√≤ che il diritto dei popoli e delle nazioni alla sovranit√† permanente sulle proprie ricchezze e risorse naturali deve essere esercitato nell'interesse del loro sviluppo nazionale. Fu un passo cruciale per l'indipendenza economica, impedendo alle ex potenze coloniali di mantenere il controllo economico attraverso concessioni sfavorevoli." }, 
              "parent": "udhr" },

            { "id": "node_28", "sigla": "Res. 1904", "type": "minor", "year": 1963, "y": 45, "class": "branch-civil", 
              "label": { en: "Declaration on the Elimination of All Forms of Racial Discrimination", it: "Dichiarazione sull'Eliminazione della Discriminazione Razziale" },
              "desc": { en: "This was the UN's first organized legal response to the institutionalized racism of Apartheid in South Africa. It solemnly affirmed that discrimination between human beings on the ground of race, colour or ethnic origin is an offense to human dignity and shall be condemned as a denial of the principles of the Charter. It explicitly stated that any doctrine of racial superiority is scientifically false, morally condemnable, socially unjust and dangerous.", it: "Questa fu la prima risposta legale organizzata dell'ONU al razzismo istituzionalizzato dell'Apartheid in Sudafrica. Afferm√≤ solennemente che la discriminazione tra esseri umani basata su razza, colore o origine etnica √® un'offesa alla dignit√† umana e deve essere condannata. Dichiar√≤ esplicitamente che qualsiasi dottrina di superiorit√† razziale √® scientificamente falsa, moralmente condannabile, socialmente ingiusta e pericolosa." }, 
              "parent": "udhr" },
            
            { "id": "ICERD", "sigla": "ICERD", "type": "main", "year": 1965, "y": 45, "class": "branch-civil", 
              "label": { en: "International Convention on the Elimination of Racial Discrimination", it: "Convenzione Internazionale sull'Eliminazione della Discriminazione Razziale" },
              "desc": { en: "ICERD was the first core binding human rights treaty adopted by the UN. It defines racial discrimination comprehensively and obliges states to eliminate it in all its forms. Uniquely, it requires states not just to abstain from discrimination, but to take 'positive measures' to eliminate it, including criminalizing hate speech and membership in racist organizations. It established the Committee on the Elimination of Racial Discrimination (CERD), the first treaty body to monitor state compliance.", it: "La ICERD √® stata il primo trattato fondamentale sui diritti umani adottato dall'ONU. Definisce la discriminazione razziale in modo completo e obbliga gli stati ad eliminarla in tutte le sue forme. In modo unico, richiede agli stati non solo di astenersi dalla discriminazione, ma di adottare 'misure positive' per eliminarla, inclusa la penalizzazione dell'incitamento all'odio. Ha istituito il Comitato per l'Eliminazione della Discriminazione Razziale (CERD), il primo organo di trattato per monitorare la conformit√† degli stati." }, 
              "link": "https://www.ohchr.org/en/instruments-mechanisms/instruments/international-convention-elimination-all-forms-racial", "ratifications": 182, "related": ["node_28"], "parent": "node_28" },
            
            { "id": "iccpr", "sigla": "ICCPR & OP1", "type": "main", "year": 1966, "y": 45, "class": "branch-civil", 
              "label": { en: "International Covenant on Civil and Political Rights", it: "Patto Internazionale sui Diritti Civili e Politici" },
              "desc": { en: "The ICCPR transforms the civil and political rights of the UDHR into binding law. It protects 'negative' rights (freedoms *from* state interference), such as the right to life, freedom of religion, freedom of speech, freedom of assembly, electoral rights, and rights to due process and a fair trial. The Optional Protocol 1 was revolutionary as it established an individual complaints mechanism, allowing citizens to bypass their own governments and appeal directly to the UN Human Rights Committee if their rights are violated.", it: "L'ICCPR trasforma i diritti civili e politici della DUDU in legge vincolante. Protegge i diritti 'negativi' (libert√† *dall'*interferenza statale), come il diritto alla vita, la libert√† di religione, di parola, di riunione, i diritti elettorali e il diritto a un giusto processo. Il Protocollo Opzionale 1 fu rivoluzionario in quanto istitu√¨ un meccanismo di reclamo individuale, consentendo ai cittadini di scavalcare i propri governi e appellarsi direttamente al Comitato Diritti Umani dell'ONU se i loro diritti vengono violati." }, 
              "link": "https://www.ohchr.org/en/instruments-mechanisms/instruments/international-covenant-civil-and-political-rights", "ratifications": 173, "related": ["udhr"], "parent": "ICERD" },
            
            { "id": "icescr", "sigla": "ICESCR", "type": "main", "year": 1966, "y": -45, "class": "branch-econ", 
              "label": { en: "International Covenant on Economic, Social and Cultural Rights", it: "Patto Internazionale sui Diritti Economici, Sociali e Culturali" },
              "desc": { en: "The ICESCR covers 'positive' rights that require state resources and action to fulfill. These include the right to work, fair wages, social security, adequate standard of living, health, education, and culture. Unlike the ICCPR, rights here are subject to 'progressive realization' based on available resources, a clause that has often allowed states to delay implementation. It reflects the Socialist and developing nations' priority during the Cold War, emphasizing equality and welfare over individual liberties.", it: "L'ICESCR copre i diritti 'positivi' che richiedono risorse e azioni statali per essere realizzati. Questi includono il diritto al lavoro, a un salario equo, alla sicurezza sociale, a uno standard di vita adeguato, alla salute e all'istruzione. A differenza dell'ICCPR, i diritti qui sono soggetti a 'realizzazione progressiva' in base alle risorse disponibili, una clausola che ha spesso permesso agli stati di ritardare l'attuazione. Riflette la priorit√† delle nazioni socialiste e in via di sviluppo durante la Guerra Fredda, enfatizzando uguaglianza e welfare." }, 
              "link": "https://www.ohchr.org/en/instruments-mechanisms/instruments/international-covenant-economic-social-and-cultural-rights", "ratifications": 171, "related": ["udhr"], "parent": "node_27" },
            
            { "id": "node_29", "sigla": "Res. 2542", "type": "minor", "year": 1969, "y": -90, "class": "branch-social", 
              "label": { en: "Declaration on Social Progress and Development", it: "Dichiarazione sul Progresso e lo Sviluppo Sociale" },
              "desc": { en: "This declaration emphasized that social progress and economic growth are not ends in themselves but means to achieve the wider goal of human dignity. It called for the elimination of inequality, exploitation, and poverty, linking the internal social policies of states with their international human rights obligations. It marked a shift towards viewing development through a human rights lens.", it: "Questa dichiarazione sottoline√≤ che il progresso sociale e la crescita economica non sono fini a se stessi, ma mezzi per raggiungere l'obiettivo pi√π ampio della dignit√† umana. Chiese l'eliminazione della disuguaglianza, dello sfruttamento e della povert√†, collegando le politiche sociali interne degli stati con i loro obblighi internazionali. Segn√≤ un passaggio verso la visione dello sviluppo attraverso la lente dei diritti umani." }, 
              "parent": "icescr" },

            { "id": "node_30", "sigla": "Res. 2856", "type": "minor", "year": 1971, "y": -90, "class": "branch-social", 
              "label": { en: "Declaration on the Rights of Mentally Retarded Persons", it: "Dichiarazione sui Diritti delle Persone con Ritardo Mentale" },
              "desc": { en: "This was the first specific international instrument to address the rights of persons with intellectual disabilities. While the terminology used is now outdated and considered offensive, historically it was a breakthrough. It asserted that persons with intellectual disabilities have, to the maximum degree of feasibility, the same rights as other human beings, including rights to medical care, economic security, and protection from exploitation.", it: "Questo fu il primo strumento internazionale specifico ad affrontare i diritti delle persone con disabilit√† intellettive. Sebbene la terminologia usata sia ora obsoleta e considerata offensiva, storicamente fu una svolta. Afferm√≤ che le persone con disabilit√† intellettive hanno, nel massimo grado possibile, gli stessi diritti degli altri esseri umani, inclusi i diritti alle cure mediche, alla sicurezza economica e alla protezione dallo sfruttamento." }, 
              "parent": "node_29" },

            { "id": "node_31", "sigla": "DOC", "type": "minor", "year": 1974, "y": -45, "class": "branch-econ", 
              "label": { en: "Universal Declaration on the Eradication of Hunger", it: "Dichiarazione Universale sull'Eradicazione della Fame" },
              "desc": { en: "Adopted by the World Food Conference, this declaration proclaimed that 'every man, woman and child has the inalienable right to be free from hunger and malnutrition'. It linked food security directly to the fundamental right to life and dignity, emphasizing that the elimination of hunger is a common responsibility of the international community, not just individual states.", it: "Adottata dalla Conferenza Mondiale sull'Alimentazione, questa dichiarazione proclam√≤ che 'ogni uomo, donna e bambino ha il diritto inalienabile di essere libero dalla fame e dalla malnutrizione'. Colleg√≤ la sicurezza alimentare direttamente al diritto fondamentale alla vita e alla dignit√†, sottolineando che l'eliminazione della fame √® una responsabilit√† comune della comunit√† internazionale." }, 
              "parent": "icescr" },

            { "id": "node_32", "sigla": "Res. 3318", "type": "minor", "year": 1974, "y": 90, "class": "branch-women", 
              "label": { en: "Declaration on Protection of Women in Emergency", it: "Dichiarazione sulla Protezione delle Donne in Emergenza" },
              "desc": { en: "This document focused specifically on the vulnerability of women and children in armed conflict and emergency situations. It condemned attacks on civilians and the use of chemical and biological weapons, highlighting that women often bear the brunt of suffering in war. It paved the way for later recognition of wartime sexual violence as a war crime.", it: "Questo documento si concentr√≤ specificamente sulla vulnerabilit√† di donne e bambini nei conflitti armati e nelle situazioni di emergenza. Condann√≤ gli attacchi ai civili e l'uso di armi chimiche e biologiche, evidenziando che le donne spesso sopportano il peso maggiore delle sofferenze in guerra. Apr√¨ la strada al successivo riconoscimento della violenza sessuale in tempo di guerra come crimine di guerra." }, 
              "parent": "iccpr" },

            { "id": "node_35", "sigla": "Res. 3452", "type": "minor", "year": 1975, "y": 45, "class": "branch-civil", 
              "label": { en: "Declaration on Protection from Torture", it: "Dichiarazione sulla Protezione dalla Tortura" },
              "desc": { en: "This declaration was the precursor to the binding 1984 Convention against Torture. It represented a strong moral condemnation, defining torture as an offense to human dignity and stating that no state may permit or tolerate torture, even in exceptional circumstances such as war or political instability. It helped build the consensus necessary for a binding treaty.", it: "Questa dichiarazione fu il precursore della Convenzione vincolante contro la Tortura del 1984. Rappresent√≤ una forte condanna morale, definendo la tortura come un'offesa alla dignit√† umana e affermando che nessuno stato pu√≤ permettere o tollerare la tortura, nemmeno in circostanze eccezionali come guerra o instabilit√† politica. Aiut√≤ a costruire il consenso necessario per un trattato vincolante." }, 
              "parent": "iccpr" },

            { "id": "node_34", "sigla": "Res. 3447", "type": "main", "year": 1975, "y": -90, "class": "branch-social", 
              "label": { en: "Declaration on the Rights of Disabled Persons", it: "Dichiarazione sui Diritti delle Persone Disabili" },
              "desc": { en: "Expanding on the 1971 declaration, this document began the slow conceptual shift from a 'medical model' (viewing disability as a defect to be fixed) to a 'rights-based model' (viewing disability as a social construct). It emphasized rights to medical treatment, rehabilitation, education, training, and employment, aiming to integrate disabled persons fully into society.", it: "Espandendo la dichiarazione del 1971, questo documento inizi√≤ il lento cambiamento concettuale dal 'modello medico' (disabilit√† come difetto da curare) al 'modello basato sui diritti' (disabilit√† come costrutto sociale). Enfatizz√≤ i diritti alle cure mediche, riabilitazione, istruzione, formazione e lavoro, mirando a integrare pienamente le persone disabili nella societ√†." }, 
              "parent": "node_30" },

            { "id": "node_33", "sigla": "Res. 3384", "type": "minor", "year": 1975, "y": 135, "class": "branch-coll", 
              "label": { en: "Declaration on Use of Scientific Progress", it: "Dichiarazione sull'Uso del Progresso Scientifico" },
              "desc": { en: "This declaration addressed the dual nature of scientific advancement. While recognizing science's potential to improve living standards, it warned against its misuse for repression, war, or violations of privacy. It asserted that all peoples have the right to share in the benefits of science and that technology must be used to strengthen international peace and security.", it: "Questa dichiarazione affront√≤ la doppia natura del progresso scientifico. Pur riconoscendo il potenziale della scienza per migliorare gli standard di vita, mise in guardia contro il suo uso improprio per repressione, guerra o violazioni della privacy. Afferm√≤ che tutti i popoli hanno il diritto di condividere i benefici della scienza e che la tecnologia deve servire la pace." }, 
              "parent": "A_RES_1514(XV)" },

            { "id": "node_36", "sigla": "DOC", "type": "minor", "year": 1978, "y": 45, "class": "branch-civil", 
              "label": { en: "Declaration on Race and Racial Prejudice (UNESCO)", it: "Dichiarazione su Razza e Pregiudizi Razziali" },
              "desc": { en: "Adopted by UNESCO, this declaration went further than previous political documents by attacking the pseudo-scientific basis of racism. It stated unequivocally that 'all human beings belong to a single species' and that theories of racial superiority or purity are scientifically false, morally condemnable, and socially unjust. It targeted culture and education as key fields to eradicate prejudice.", it: "Adottata dall'UNESCO, questa dichiarazione and√≤ oltre i precedenti documenti politici attaccando le basi pseudo-scientifiche del razzismo. Afferm√≤ inequivocabilmente che 'tutti gli esseri umani appartengono a una sola specie' e che le teorie di superiorit√† razziale sono scientificamente false. Punt√≤ su cultura ed educazione come campi chiave per sradicare il pregiudizio." }, 
              "parent": "node_35" },
            
            { "id": "CEDAW", "sigla": "CEDAW", "type": "main", "year": 1979, "y": 90, "class": "branch-women", 
              "label": { en: "Convention on Elimination of Discrimination against Women", it: "Convenzione sull'Eliminazione della Discriminazione contro le Donne" },
              "desc": { en: "Often described as the 'International Bill of Rights for Women', CEDAW is unique because it targets culture and tradition as influential forces. Unlike previous treaties, it addresses discrimination in both the public and private spheres (including family life). It defines discrimination against women as any distinction, exclusion, or restriction made on the basis of sex which impairs the enjoyment of human rights. It obliges states to take measures to modify social and cultural patterns of conduct to eliminate prejudices and customary practices based on the idea of the inferiority or the superiority of either of the sexes.", it: "Spesso descritta come la 'Carta dei Diritti delle Donne', la CEDAW √® unica perch√© punta alla cultura e alla tradizione come forze influenti. A differenza dei trattati precedenti, affronta la discriminazione sia nella sfera pubblica che in quella privata (inclusa la vita familiare). Definisce la discriminazione contro le donne come qualsiasi distinzione basata sul sesso che compromette il godimento dei diritti. Obbliga gli stati a modificare i modelli sociali e culturali per eliminare pregiudizi e pratiche basate sull'idea di inferiorit√† di uno dei sessi." }, 
              "link": "https://www.ohchr.org/en/instruments-mechanisms/instruments/convention-elimination-all-forms-discrimination-against-women", "ratifications": 189, "related": ["udhr", "iccpr"], "parent": "node_32" },
            
            { "id": "A_RES_36_55", "sigla": "Res. 36/55", "type": "main", "year": 1981, "y": 45, "class": "branch-civil", 
              "label": { en: "Declaration on Elimination of Intolerance Based on Religion", it: "Dichiarazione sull'Eliminazione dell'Intolleranza Religiosa" },
              "desc": { en: "This is the most comprehensive UN instrument devoted specifically to freedom of religion and belief. It details the rights of individuals to have, change, or manifest their religion without coercion or discrimination. It specifically protects the rights of parents to organize family life in accordance with their religion and the rights of religious groups to maintain charitable or humanitarian institutions.", it: "Questo √® lo strumento ONU pi√π completo dedicato specificamente alla libert√† di religione e di credo. Dettaglia i diritti degli individui di avere, cambiare o manifestare la propria religione senza coercizione o discriminazione. Protegge specificamente i diritti dei genitori di organizzare la vita familiare secondo la loro religione e i diritti dei gruppi religiosi di mantenere istituzioni caritatevoli." }, 
              "parent": "node_36" },

            { "id": "A_RES_37_194", "sigla": "Res. 37/194", "type": "minor", "year": 1982, "y": 45, "class": "branch-civil", 
              "label": { en: "Principles of Medical Ethics for Prisoners", it: "Principi di Etica Medica per i Prigionieri" },
              "desc": { en: "This resolution addresses the role of health personnel, particularly physicians, in the protection of prisoners. It explicitly declares that it is a gross contravention of medical ethics for health personnel to engage, actively or passively, in acts which constitute participation in, complicity in, incitement to or attempts to commit torture or other cruel, inhuman or degrading treatment.", it: "Questa risoluzione affronta il ruolo del personale sanitario nella protezione dei prigionieri. Dichiara esplicitamente che √® una grave violazione dell'etica medica per il personale sanitario impegnarsi, attivamente o passivamente, in atti che costituiscono partecipazione, complicit√† o incitamento alla tortura o altri trattamenti crudeli." }, 
              "parent": "A_RES_36_55" },

            { "id": "E_RES_1984_50", "sigla": "Res. 84/50", "type": "minor", "year": 1984, "y": 45, "class": "branch-civil", 
              "label": { en: "Safeguards on Death Penalty", it: "Garanzie sulla Pena di Morte" },
              "desc": { en: "While not abolishing the death penalty, this document established strict legal safeguards for countries that still retain it. It mandates that capital punishment may only be imposed for the 'most serious crimes', requires a final judgment from a competent court, guarantees the right to appeal and seek pardon, and prohibits the execution of pregnant women, new mothers, and persons who have become insane.", it: "Pur non abolendo la pena di morte, questo documento stabil√¨ rigorose garanzie legali per i paesi che la mantengono. Stabilisce che la pena capitale pu√≤ essere imposta solo per i 'crimini pi√π gravi', richiede una sentenza definitiva, garantisce il diritto di appello e di chiedere la grazia, e vieta l'esecuzione di donne incinte e persone divenute insani di mente." }, 
              "parent": "A_RES_37_194" },

            { "id": "A_RES_39_11", "sigla": "Res. 39/11", "type": "minor", "year": 1984, "y": 135, "class": "branch-coll", 
              "label": { en: "Declaration on the Right of Peoples to Peace", it: "Dichiarazione sul Diritto alla Pace" },
              "desc": { en: "Adopted during renewed Cold War tensions, this declaration asserted that the peoples of our planet have a sacred right to peace. It emphasized that the preservation of the right of peoples to peace and the promotion of its implementation constitute a fundamental obligation of each State. It linked the absence of war directly to the possibility of realizing all other human rights.", it: "Adottata durante le rinnovate tensioni della Guerra Fredda, questa dichiarazione afferm√≤ che i popoli del nostro pianeta hanno un sacro diritto alla pace. Sottoline√≤ che la preservazione del diritto alla pace costituisce un obbligo fondamentale di ogni Stato. Colleg√≤ l'assenza di guerra direttamente alla possibilit√† di realizzare tutti gli altri diritti umani." }, 
              "parent": "node_33" },
            
            { "id": "CAT", "sigla": "CAT", "type": "main", "year": 1984, "y": 45, "class": "branch-civil", 
              "label": { en: "Convention against Torture", it: "Convenzione contro la Tortura" },
              "desc": { en: "The CAT codified the absolute prohibition of torture under international law. It requires states to take effective measures to prevent torture within their borders and forbids them from transporting people to any country where there is reason to believe they will be tortured (the principle of **Non-Refoulement**). It firmly established that 'no exceptional circumstances whatsoever', whether war or public emergency, may be invoked as a justification of torture. It also established universal jurisdiction for torturers, meaning they can be prosecuted anywhere.", it: "La CAT ha codificato il divieto assoluto di tortura nel diritto internazionale. Richiede agli stati di adottare misure efficaci per prevenire la tortura e vieta loro di trasportare persone in paesi dove potrebbero essere torturate (principio di **Non-Refoulement**). Ha stabilito fermamente che 'nessuna circostanza eccezionale', che sia guerra o emergenza pubblica, pu√≤ giustificare la tortura. Ha anche stabilito la giurisdizione universale per i torturatori." }, 
              "link": "https://www.ohchr.org/en/instruments-mechanisms/instruments/convention-against-torture-and-other-cruel-inhuman-or-degrading", "ratifications": 173, "related": ["node_35"], "parent": "E_RES_1984_50" },
            
            { "id": "A_RES_40_32", "sigla": "Res. 40/32", "type": "minor", "year": 1985, "y": 45, "class": "branch-civil", 
              "label": { en: "Principles on Independence of Judiciary", it: "Principi sull'Indipendenza della Magistratura" },
              "desc": { en: "These principles were adopted to protect the judicial process from political interference. They state that the independence of the judiciary shall be guaranteed by the State and enshrined in the Constitution or law. Judges must decide matters impartially, on the basis of facts and in accordance with the law, without any restrictions, improper influences, inducements, pressures, threats or interferences.", it: "Questi principi furono adottati per proteggere il processo giudiziario dalle interferenze politiche. Affermano che l'indipendenza della magistratura deve essere garantita dallo Stato. I giudici devono decidere in modo imparziale, sulla base dei fatti e in conformit√† con la legge, senza restrizioni, influenze improprie, pressioni, minacce o interferenze." }, 
              "parent": "CAT" },

            { "id": "A_RES_40_144", "sigla": "Res. 40/144", "type": "minor", "year": 1985, "y": 45, "class": "branch-civil", 
              "label": { en: "Human Rights of Non-Nationals", it: "Diritti Umani dei Non Cittadini" },
              "desc": { en: "This declaration clarified that fundamental human rights apply to all individuals within a state's territory, regardless of citizenship. While acknowledging state sovereignty over borders, it affirmed that aliens must not be subjected to arbitrary arrest, torture, or inhuman treatment, and must enjoy the right to life, legal personality, and marriage.", it: "Questa dichiarazione chiar√¨ che i diritti umani fondamentali si applicano a tutti gli individui nel territorio di uno stato, indipendentemente dalla cittadinanza. Pur riconoscendo la sovranit√† statale sui confini, afferm√≤ che gli stranieri non devono essere sottoposti ad arresti arbitrari o torture e devono godere del diritto alla vita e alla personalit√† giuridica." }, 
              "parent": "A_RES_40_32" },

            { "id": "node_9", "sigla": "DOC", "type": "minor", "year": 1986, "y": 135, "class": "branch-coll", 
              "label": { en: "Declaration on the Right to Development", it: "Dichiarazione sul Diritto allo Sviluppo" },
              "desc": { en: "A landmark document pushed by the Global South, it framed 'development' not just as an economic process but as a comprehensive human rights process. It asserts that every human person and all peoples are entitled to participate in, contribute to, and enjoy economic, social, cultural and political development.", it: "Documento storico spinto dal Sud Globale, inquadr√≤ lo 'sviluppo' non solo come processo economico ma come processo di diritti umani. Afferma che ogni persona umana e tutti i popoli hanno il diritto di partecipare, contribuire e godere dello sviluppo economico, sociale, culturale e politico." }, 
              "parent": "A_RES_39_11" },
            
            { "id": "A_RES_41_128", "sigla": "Res. 41/128", "type": "main", "year": 1986, "y": 135, "class": "branch-coll", 
              "label": { en: "Declaration on the Right to Development", it: "Dichiarazione sul Diritto allo Sviluppo" },
              "desc": { en: "This declaration formalized the concept that development is an inalienable human right. It emphasizes that the human person is the central subject of development and should be the active participant and beneficiary of the right to development. It holds states responsible for creating national and international conditions favorable to the realization of this right, linking international cooperation directly to individual well-being.", it: "Questa dichiarazione formalizz√≤ il concetto che lo sviluppo √® un diritto umano inalienabile. Sottolinea che la persona umana √® il soggetto centrale dello sviluppo e deve esserne il partecipante attivo e il beneficiario. Ritiene gli stati responsabili della creazione di condizioni nazionali e internazionali favorevoli alla realizzazione di questo diritto." }, 
              "parent": "node_9" },
            
            { "id": "A_RES_43_173", "sigla": "Res. 43/173", "type": "minor", "year": 1988, "y": 45, "class": "branch-civil", 
              "label": { en: "Principles for Protection of Detainees", it: "Principi per la Protezione dei Detenuti" },
              "desc": { en: "This comprehensive set of principles established minimum standards for the treatment of all persons under any form of detention or imprisonment. Key provisions include the absolute prohibition of 'incommunicado' detention, the right to be informed of reasons for arrest, the right to legal counsel, and the requirement that all detainees be treated with humanity and respect for their inherent dignity.", it: "Questo insieme completo di principi stabil√¨ standard minimi per il trattamento di tutte le persone in detenzione. Le disposizioni chiave includono il divieto assoluto di detenzione 'incommunicado', il diritto di essere informati dei motivi dell'arresto, il diritto all'assistenza legale e l'obbligo di trattare tutti i detenuti con umanit√†." }, 
              "parent": "A_RES_40_144" },

            { "id": "ICCPR-OP2", "sigla": "OP2-ICCPR", "type": "minor", "year": 1989, "y": 45, "class": "branch-civil", 
              "label": { en: "ICCPR Optional Protocol on Death Penalty", it: "Protocollo Opzionale ICCPR sulla Pena di Morte" },
              "desc": { en: "This protocol is the only universal treaty aiming at the complete abolition of the death penalty. States that ratify it commit to permanently ending executions and taking all necessary measures to abolish the death penalty within their jurisdiction. It reflects the growing international consensus that capital punishment is a violation of the right to life and the right not to be subjected to cruel punishment.", it: "Questo protocollo √® l'unico trattato universale che mira alla completa abolizione della pena di morte. Gli stati che lo ratificano si impegnano a porre fine permanentemente alle esecuzioni e ad adottare tutte le misure necessarie per abolire la pena di morte. Riflette il crescente consenso sul fatto che la pena capitale sia una violazione del diritto alla vita." }, 
              "ratifications": 90, "parent": "A_RES_43_173" },
            
            { "id": "CRC", "sigla": "CRC", "type": "main", "year": 1989, "y": -90, "class": "branch-social", 
              "label": { en: "Convention on the Rights of the Child", it: "Convenzione sui Diritti dell'Infanzia" },
              "desc": { en: "The CRC is the most widely ratified human rights treaty in history. It fundamentally changed the status of children from 'objects of charity' to 'subjects of rights'. It rests on four core principles: non-discrimination, the right to life and development, the right to be heard (participation), and the **Best Interests of the Child** as a primary consideration in all actions concerning children. It protects children from economic exploitation, violence, and neglect.", it: "La CRC √® il trattato sui diritti umani pi√π ratificato della storia. Ha cambiato radicalmente lo status dei bambini da 'oggetti di carit√†' a 'soggetti di diritto'. Si basa su quattro principi: non discriminazione, diritto alla vita e allo sviluppo, diritto di essere ascoltati (partecipazione) e il **Superiore Interesse del Minore** come considerazione primaria. Protegge i bambini dallo sfruttamento economico, dalla violenza e dall'abbandono." }, 
              "link": "https://www.ohchr.org/en/instruments-mechanisms/instruments/convention-rights-child", "ratifications": 196, "related": ["udhr"], "parent": "node_34" },
            
            { "id": "node_45", "sigla": "DOC", "type": "minor", "year": 1990, "y": 45, "class": "branch-civil", 
              "label": { en: "Principles on Role of Lawyers", it: "Principi sul Ruolo degli Avvocati" },
              "desc": { en: "Recognizing that the rule of law requires effective legal representation, these principles mandate governments to ensure that lawyers can perform their professional functions without intimidation, hindrance, harassment, or improper interference. It guarantees the right of everyone to call upon the assistance of a lawyer of their choice to protect and establish their rights.", it: "Riconoscendo che lo stato di diritto richiede una rappresentanza legale efficace, questi principi obbligano i governi a garantire che gli avvocati possano svolgere le loro funzioni senza intimidazioni o interferenze. Garantisce il diritto di ognuno di avvalersi dell'assistenza di un avvocato di propria scelta per proteggere i propri diritti." }, 
              "parent": "ICCPR-OP2" },
            
            { "id": "CMW", "sigla": "CMW", "type": "main", "year": 1990, "y": -45, "class": "branch-econ", 
              "label": { en: "Convention on Rights of Migrant Workers", it: "Convenzione sui Diritti dei Lavoratori Migranti" },
              "desc": { en: "The CMW is a comprehensive treaty aimed at protecting the rights of migrant workers and their families, a group often vulnerable to exploitation and xenophobia. It grants them equality of treatment with nationals regarding working conditions and social security. However, it suffers from a low ratification rate, particularly among Western migrant-receiving states, reflecting the political sensitivity of migration control versus human rights.", it: "La CMW √® un trattato completo volto a proteggere i diritti dei lavoratori migranti e delle loro famiglie, un gruppo spesso vulnerabile allo sfruttamento. Garantisce loro parit√† di trattamento con i cittadini per quanto riguarda le condizioni di lavoro. Tuttavia, soffre di un basso tasso di ratifica, specialmente tra gli stati occidentali di destinazione, riflettendo la sensibilit√† politica del controllo della migrazione." }, 
              "link": "https://www.ohchr.org/en/instruments-mechanisms/instruments/international-convention-protection-rights-all-migrant-workers", "ratifications": 58, "parent": "node_31" },
            
            { "id": "A_RES_45_111", "sigla": "Res. 45/111", "type": "minor", "year": 1990, "y": 45, "class": "branch-civil", 
              "label": { en: "Principles for Treatment of Prisoners", it: "Principi per il Trattamento dei Prigionieri" },
              "desc": { en: "This resolution established the fundamental principle that 'all prisoners shall be treated with the respect due to their inherent dignity and value as human beings'. Crucially, it stated that the purpose of the prison sentence is essentially reformation and social rehabilitation, not just punishment. It promotes the prisoners' continued connection to the outside world and access to education.", it: "Questa risoluzione stabil√¨ il principio che 'tutti i prigionieri devono essere trattati con il rispetto dovuto alla loro dignit√†'. Crucialmente, afferm√≤ che lo scopo della pena detentiva √® essenzialmente la riforma e la riabilitazione sociale, non solo la punizione. Promuove la connessione continua dei prigionieri con il mondo esterno e l'accesso all'istruzione." }, 
              "parent": "node_45" },

            { "id": "A_RES_47_135", "sigla": "Res. 47/135", "type": "minor", "year": 1992, "y": 135, "class": "branch-coll", 
              "label": { en: "Declaration on Rights of Minorities", it: "Dichiarazione sui Diritti delle Minoranze" },
              "desc": { en: "Adopted after the ethnic conflicts that erupted following the Cold War, this declaration requires states to protect the existence and the national or ethnic, cultural, religious and linguistic identity of minorities within their respective territories. It emphasizes the right of minorities to participate effectively in decisions on the national and regional level concerning the minority to which they belong.", it: "Adottata dopo i conflitti etnici seguiti alla Guerra Fredda, questa dichiarazione richiede agli stati di proteggere l'esistenza e l'identit√† nazionale, etnica, culturale, religiosa e linguistica delle minoranze. Sottolinea il diritto delle minoranze di partecipare efficacemente alle decisioni a livello nazionale e regionale che le riguardano." }, 
              "parent": "A_RES_41_128" },
            
            { "id": "A_CONF.151_26", "sigla": "Rio Decl.", "type": "main", "year": 1992, "y": -135, "class": "branch-env", 
              "label": { en: "Rio Declaration on Environment", it: "Dichiarazione di Rio sull'Ambiente" },
              "desc": { en: "The Rio Declaration was a pivotal moment linking human rights with environmental protection. It established 27 principles, including the **Precautionary Principle** and the principle of 'Common but Differentiated Responsibilities'. It asserted that human beings are at the centre of concerns for sustainable development and are entitled to a healthy and productive life in harmony with nature.", it: "La Dichiarazione di Rio fu un momento cruciale per legare i diritti umani alla protezione ambientale. Stabil√¨ 27 principi, tra cui il **Principio di Precauzione** e le 'Responsabilit√† Comuni ma Differenziate'. Afferm√≤ che gli esseri umani sono al centro dello sviluppo sostenibile e hanno diritto a una vita sana e produttiva in armonia con la natura." }, 
              "parent": "node_31" },
            
            { "id": "A_RES_47_133", "sigla": "Res. 47/133", "type": "minor", "year": 1992, "y": 45, "class": "branch-civil", 
              "label": { en: "Declaration on Protection from Enforced Disappearance", it: "Dichiarazione contro le Sparizioni Forzate" },
              "desc": { en: "Prompted by the 'Dirty Wars' in Latin America where thousands vanished, this declaration defined enforced disappearance as an offense to human dignity. It laid out the state's obligation to investigate disappearances and hold perpetrators accountable, setting the stage for the later binding convention. It recognized the anguish of families as a form of torture.", it: "Sollecitata dalle 'Guerre Sporche' in America Latina, questa dichiarazione defin√¨ la sparizione forzata come un'offesa alla dignit√† umana. Stabil√¨ l'obbligo dello stato di indagare sulle sparizioni e punire i colpevoli, preparando il terreno per la convenzione vincolante. Riconobbe l'angoscia delle famiglie come una forma di tortura." }, 
              "parent": "A_RES_45_111" },
            
            { "id": "A_RES_48_104", "sigla": "Res. 48/104", "type": "main", "year": 1993, "y": 90, "class": "branch-women", 
              "label": { en: "Declaration on Elimination of Violence against Women", it: "Dichiarazione contro la Violenza sulle Donne" },
              "desc": { en: "This was the first international instrument to explicitly address violence against women, defining it as any act of gender-based violence that results in physical, sexual or psychological harm. Crucially, it broke the silence regarding domestic violence, asserting that states cannot invoke custom, tradition, or religious consideration to avoid their obligations to eliminate such violence.", it: "Questo fu il primo strumento internazionale ad affrontare esplicitamente la violenza contro le donne, definendola come qualsiasi atto di violenza di genere che comporti danni fisici, sessuali o psicologici. Crucialmente, ruppe il silenzio sulla violenza domestica, affermando che gli stati non possono invocare consuetudini, tradizioni o considerazioni religiose per evitare i loro obblighi." }, 
              "related": ["CEDAW"], "parent": "CEDAW" },
            
            { "id": "A_CONF.157_23", "sigla": "Vienna", "type": "minor", "year": 1993, "y": 45, "class": "branch-civil", 
              "label": { en: "Vienna Declaration", it: "Dichiarazione di Vienna" },
              "desc": { en: "Adopted at the World Conference on Human Rights, this document ended the Cold War debate over which rights were superior. It famously declared that **'All human rights are universal, indivisible, interdependent and interrelated'**. It called for the establishment of a High Commissioner for Human Rights, creating a permanent office to monitor violations globally.", it: "Adottata alla Conferenza Mondiale sui Diritti Umani, pose fine al dibattito della Guerra Fredda su quali diritti fossero superiori. Dichiar√≤ che **'Tutti i diritti umani sono universali, indivisibili, interdipendenti e interconnessi'**. Chiese l'istituzione di un Alto Commissario per i Diritti Umani, creando un ufficio permanente per monitorare le violazioni." }, 
              "parent": "A_RES_47_133" },
            
            { "id": "node_52", "sigla": "DOC", "type": "main", "year": 1997, "y": -90, "class": "branch-social", 
              "label": { en: "Declaration on Human Genome", it: "Dichiarazione sul Genoma Umano" },
              "desc": { en: "As biotechnology advanced, UNESCO adopted this declaration to prevent genetic discrimination. It asserts that the human genome is the 'heritage of humanity' and that no one shall be subjected to discrimination based on genetic characteristics. It explicitly bans human cloning as contrary to human dignity.", it: "Con l'avanzare delle biotecnologie, l'UNESCO adott√≤ questa dichiarazione per prevenire la discriminazione genetica. Afferma che il genoma umano √® 'patrimonio dell'umanit√†' e che nessuno deve essere discriminato in base alle caratteristiche genetiche. Vieta esplicitamente la clonazione umana come contraria alla dignit√† umana." }, 
              "parent": "CRC" },
            
            { "id": "A_RES_53_144", "sigla": "Res. 53/144", "type": "minor", "year": 1998, "y": 45, "class": "branch-civil", 
              "label": { en: "Declaration on Human Rights Defenders", it: "Dichiarazione sui Difensori dei Diritti Umani" },
              "desc": { en: "This declaration recognizes the vital role of individuals and groups who work to promote human rights. It grants them the right to meet, assemble, and seek resources. Importantly, it obliges states to protect these defenders from violence, threats, retaliation, or arbitrary legal action as a consequence of their legitimate human rights work.", it: "Questa dichiarazione riconosce il ruolo vitale di individui e gruppi che lavorano per promuovere i diritti umani. Garantisce loro il diritto di riunirsi e cercare risorse. √à importante sottolineare che obbliga gli stati a proteggere questi difensori da violenza, minacce, ritorsioni o azioni legali arbitrarie come conseguenza del loro legittimo lavoro." }, 
              "parent": "A_CONF.157_23" },

            { "id": "OP-CEDAW", "sigla": "OP-CEDAW", "type": "minor", "year": 1999, "y": 45, "class": "branch-civil", 
              "label": { en: "Optional Protocol CEDAW", it: "Protocollo Opzionale CEDAW" },
              "desc": { en: "This protocol strengthened the enforcement of the Women's Convention (CEDAW) by establishing an inquiry and complaints mechanism. It allows individual women or groups to submit complaints directly to the CEDAW Committee if their rights have been violated and domestic remedies have been exhausted. It was a major step in making women's rights legally justiciable.", it: "Questo protocollo ha rafforzato l'applicazione della Convenzione sulle Donne (CEDAW) istituendo un meccanismo di inchiesta e reclamo. Consente a singole donne o gruppi di presentare reclami direttamente al Comitato CEDAW se i loro diritti sono stati violati. √à stato un passo importante per rendere i diritti delle donne legalmente giustiziabili." }, 
              "parent": "A_RES_53_144" },

            { "id": "node_56", "sigla": "DOC", "type": "minor", "year": 2001, "y": 135, "class": "branch-coll", 
              "label": { en: "Declaration on Cultural Diversity", it: "Dichiarazione sulla Diversit√† Culturale" },
              "desc": { en: "Adopted by UNESCO in the wake of 9/11, this declaration asserts that cultural diversity is as necessary for humankind as biodiversity is for nature. It frames the defense of cultural diversity as an ethical imperative inseparable from respect for human dignity, countering the narrative of a 'clash of civilizations'.", it: "Adottata dall'UNESCO all'indomani dell'11 settembre, questa dichiarazione afferma che la diversit√† culturale √® necessaria per l'umanit√† quanto la biodiversit√† lo √® per la natura. Inquadra la difesa della diversit√† culturale come un imperativo etico inseparabile dal rispetto della dignit√† umana, contrastando la narrazione dello 'scontro di civilt√†'." }, 
              "parent": "A_RES_47_135" },

            { "id": "node_17", "sigla": "OP-CAT", "type": "minor", "year": 2002, "y": 45, "class": "branch-civil", 
              "label": { en: "Optional Protocol CAT", it: "Protocollo Opzionale CAT" },
              "desc": { en: "The OP-CAT established a proactive system to prevent torture. Instead of just reacting to complaints, it created a system of regular visits to places of detention by independent international and national bodies (National Preventive Mechanisms). The idea is that transparency and external scrutiny are the most effective deterrents against abuse behind closed doors.", it: "L'OP-CAT ha istituito un sistema proattivo per prevenire la tortura. Invece di reagire solo ai reclami, ha creato un sistema di visite regolari ai luoghi di detenzione da parte di organi indipendenti. L'idea √® che la trasparenza e il controllo esterno siano i deterrenti pi√π efficaci contro gli abusi a porte chiuse." }, 
              "parent": "OP-CEDAW" },

            { "id": "OP-CRPD", "sigla": "OP-CRPD", "type": "minor", "year": 2006, "y": 45, "class": "branch-civil", 
              "label": { en: "Optional Protocol CRPD", it: "Protocollo Opzionale CRPD" },
              "desc": { en: "This protocol allows the Committee on the Rights of Persons with Disabilities to receive and consider communications from individuals claiming to be victims of a violation of the CRPD. It empowers people with disabilities to claim their rights on an international stage when their own governments fail to protect them.", it: "Questo protocollo consente al Comitato sui Diritti delle Persone con Disabilit√† di ricevere e considerare comunicazioni da individui che affermano di essere vittime di una violazione della CRPD. Conferisce alle persone con disabilit√† il potere di rivendicare i propri diritti sulla scena internazionale." }, 
              "parent": "node_17" },
            
            { "id": "CRPD", "sigla": "CRPD", "type": "main", "year": 2006, "y": -90, "class": "branch-social", 
              "label": { en: "Convention on Rights of Persons with Disabilities", it: "Convenzione sui Diritti dei Disabili" },
              "desc": { en: "The CRPD represents a paradigm shift from viewing persons with disabilities as objects of charity to active subjects with rights. It enshrines principles like 'Reasonable Accommodation', ensuring that society adapts to the individual, not vice versa. It recognizes legal capacity for all, challenging guardianship laws that strip disabled people of their autonomy. It is the first comprehensive human rights treaty of the 21st century.", it: "La CRPD rappresenta un cambio di paradigma: da oggetti di carit√† a soggetti attivi con diritti. Sancisce principi come l'Accomodamento Ragionevole', assicurando che la societ√† si adatti all'individuo. Riconosce la capacit√† giuridica per tutti, sfidando le leggi sulla tutela che privano i disabili della loro autonomia. √à il primo trattato completo sui diritti umani del 21¬∞ secolo." }, 
              "link": "https://www.ohchr.org/en/instruments-mechanisms/instruments/convention-rights-persons-disabilities", "ratifications": 185, "related": ["node_34"], "parent": "node_52" },
            
            { "id": "CPED", "sigla": "CPED", "type": "main", "year": 2006, "y": 45, "class": "branch-civil", 
              "label": { en: "Convention against Enforced Disappearance", it: "Convenzione contro le Sparizioni Forzate" },
              "desc": { en: "This convention defines enforced disappearance as a crime against humanity when practiced in a widespread or systematic manner. It establishes the 'Right to the Truth' for victims and their families regarding the circumstances of the disappearance. It criminalizes the act of holding someone in secret detention and refusing to acknowledge their whereabouts, holding states strictly liable.", it: "Questa convenzione definisce la sparizione forzata come un crimine contro l'umanit√† se praticata in modo diffuso o sistematico. Stabilisce il 'Diritto alla Verit√†' per le vittime e le loro famiglie. Criminalizza l'atto di detenere qualcuno in segreto rifiutando di riconoscerne la posizione, ritenendo gli stati strettamente responsabili." }, 
              "link": "https://www.ohchr.org/en/instruments-mechanisms/instruments/international-convention-protection-all-persons-enforced", "ratifications": 72, "related": ["A_RES_47_133"], "parent": "OP-CRPD" },
            
            { "id": "UNDRIP", "sigla": "UNDRIP", "type": "main", "year": 2007, "y": 135, "class": "branch-coll", 
              "label": { en: "Declaration on Rights of Indigenous Peoples", it: "Dichiarazione sui Diritti dei Popoli Indigeni" },
              "desc": { en: "Adopted after 25 years of negotiation, UNDRIP recognizes the collective rights of Indigenous peoples to their culture, identity, language, employment, health, education, and natural resources. A key concept is **Free, Prior and Informed Consent (FPIC)**, meaning states should consult indigenous peoples before undertaking projects on their lands. It was initially voted against by the US, Canada, Australia, and New Zealand, though they later endorsed it.", it: "Adottata dopo 25 anni di negoziati, l'UNDRIP riconosce i diritti collettivi dei popoli indigeni alla loro cultura, identit√†, lingua, terra e risorse. Un concetto chiave √® il **Consenso Libero, Prioritario e Informato (FPIC)**: gli stati devono consultare i popoli indigeni prima di progetti sulle loro terre. Inizialmente votata contro da USA, Canada, Australia e Nuova Zelanda, che poi l'hanno sostenuta." }, 
              "related": ["node_2"], "parent": "node_56" },
            
            { "id": "node_22", "sigla": "OP-ICESCR", "type": "minor", "year": 2008, "y": -45, "class": "branch-econ", 
              "label": { en: "Optional Protocol ICESCR", it: "Protocollo Opzionale ICESCR" },
              "desc": { en: "This protocol finally put economic and social rights on the same footing as civil and political rights by establishing a complaints mechanism. It allows individuals to file complaints to the UN if their rights to health, housing, or education are violated, proving that these rights are not just aspirations but justiciable legal entitlements.", it: "Questo protocollo ha finalmente messo i diritti economici e sociali sullo stesso piano di quelli civili e politici istituendo un meccanismo di reclamo. Consente agli individui di presentare reclami all'ONU se i loro diritti alla salute, alla casa o all'istruzione sono violati, dimostrando che questi diritti sono diritti legali giustiziabili." }, 
              "parent": "CMW" },

            { "id": "A_RES_65_229", "sigla": "Bangkok", "type": "minor", "year": 2010, "y": 90, "class": "branch-women", 
              "label": { en: "Bangkok Rules (Women Prisoners)", it: "Regole di Bangkok (Donne Detenute)" },
              "desc": { en: "These rules supplement standard prison rules by addressing the specific needs of female prisoners, which had long been overlooked in male-centric penal systems. They cover issues such as gender-specific healthcare, hygiene, the treatment of pregnant women and nursing mothers, and the preservation of family links, emphasizing non-custodial measures where possible.", it: "Queste regole integrano le norme carcerarie standard affrontando i bisogni specifici delle donne detenute, a lungo trascurati in sistemi penali maschio-centrici. Coprono questioni come l'assistenza sanitaria di genere, l'igiene, il trattamento delle donne incinte e il mantenimento dei legami familiari." }, 
              "parent": "A_RES_48_104" },
            
            { "id": "node_23", "sigla": "UNGPs", "type": "main", "year": 2011, "y": -135, "class": "branch-env", 
              "label": { en: "Guiding Principles on Business and Human Rights", it: "Principi Guida su Imprese e Diritti Umani" },
              "desc": { en: "Known as the 'Ruggie Principles', these established the global standard for preventing and addressing the risk of adverse impacts on human rights linked to business activity. They rest on three pillars: the State duty to Protect against rights abuses, the Corporate responsibility to Respect human rights, and the need for greater Access to Remedy for victims. They address the accountability gap in globalization.", it: "Noti come 'Principi Ruggie', hanno stabilito lo standard globale per prevenire gli impatti negativi delle imprese sui diritti umani. Si basano su tre pilastri: il dovere dello Stato di Proteggere, la responsabilit√† delle Imprese di Rispettare i diritti e la necessit√† di un maggiore Accesso al Rimedio per le vittime. Affrontano il vuoto di responsabilit√† nella globalizzazione." }, 
              "parent": "A_CONF.151_26" },
            
            { "id": "OP-CRC-IC", "sigla": "OP-CRC-IC", "type": "minor", "year": 2011, "y": 45, "class": "branch-civil", 
              "label": { en: "OP CRC Communications", it: "OP CRC Comunicazioni" },
              "desc": { en: "This protocol allows children (or their representatives) to bring complaints directly to the UN Committee on the Rights of the Child if their specific rights have been violated. It reinforces the status of the child as a rights-holder with the capacity to seek justice internationally.", it: "Questo protocollo consente ai bambini (o ai loro rappresentanti) di presentare reclami direttamente al Comitato ONU sui Diritti dell'Infanzia. Rafforza lo status del bambino come titolare di diritti con la capacit√† di cercare giustizia a livello internazionale." }, 
              "parent": "CPED" },

            { "id": "node_61", "sigla": "Res. 21/11", "type": "minor", "year": 2012, "y": -45, "class": "branch-econ", 
              "label": { en: "Principles on Extreme Poverty", it: "Principi su Povert√† Estrema" },
              "desc": { en: "These guiding principles declare that extreme poverty is not just an economic condition but a violation of human rights. It asserts that poverty is a cause and consequence of rights abuses, and calls on states to treat people living in poverty as agents of change rather than passive recipients of charity.", it: "Questi principi guida dichiarano che la povert√† estrema non √® solo una condizione economica ma una violazione dei diritti umani. Afferma che la povert√† √® causa e conseguenza di abusi dei diritti e invita gli stati a trattare le persone povere come agenti di cambiamento." }, 
              "parent": "node_22" },

            { "id": "A_RES_70_175", "sigla": "Mandela", "type": "minor", "year": 2015, "y": 45, "class": "branch-civil", 
              "label": { en: "Nelson Mandela Rules", it: "Regole Nelson Mandela" },
              "desc": { en: "A major update to the 1955 standard rules for prisoners. Named after Mandela, they emphasize that prisoners are human beings with dignity. They set strict limits on solitary confinement (defining it as torture if prolonged), prohibit reduction of diet, and strengthen medical independence in prisons.", it: "Un importante aggiornamento alle regole del 1955. Chiamate cos√¨ in onore di Mandela, sottolineano che i prigionieri sono esseri umani con dignit√†. Pongono limiti rigorosi all'isolamento (definendolo tortura se prolungato), vietano la riduzione del cibo e rafforzano l'indipendenza medica nelle carceri." }, 
              "parent": "OP-CRC-IC" },

            { "id": "A_RES_73_165", "sigla": "Res. 73/165", "type": "minor", "year": 2018, "y": -45, "class": "branch-econ", 
              "label": { en: "Declaration on Rights of Peasants", it: "Dichiarazione sui Diritti dei Contadini" },
              "desc": { en: "This declaration addresses the rights of people working in rural areas, recognizing their connection to the land and seeds. It protects rights to land tenure, traditional farming methods, and seeds, aiming to protect small-scale farmers from industrial agriculture and displacement.", it: "Questa dichiarazione affronta i diritti delle persone che lavorano nelle aree rurali, riconoscendo il loro legame con la terra e le sementi. Protegge i diritti alla propriet√† della terra, ai metodi agricoli tradizionali e alle sementi, mirando a proteggere i piccoli agricoltori." }, 
              "parent": "node_61" },
            
            { "id": "A_RES_76_300", "sigla": "Res. 76/300", "type": "main", "year": 2022, "y": -135, "class": "branch-env", 
              "label": { en: "Right to a Clean Environment", it: "Diritto a un Ambiente Pulito" },
              "desc": { en: "In a historic resolution, the General Assembly declared that the right to a clean, healthy and sustainable environment is a universal human right. While not a treaty itself, it elevates environmental protection to the same political status as peace and security, acknowledging that climate change, pollution, and biodiversity loss interfere with the enjoyment of all other human rights.", it: "In una risoluzione storica, l'Assemblea Generale ha dichiarato che il diritto a un ambiente pulito, sano e sostenibile √® un diritto umano universale. Pur non essendo un trattato, eleva la protezione ambientale allo stesso status politico della pace, riconoscendo che il cambiamento climatico interferisce con il godimento di tutti gli altri diritti umani." }, 
              "parent": "node_23" }
        ];

        const history = [
            { year: 1945, label: { en: "End of WWII / UN Created", it: "Fine WWII / Creazione ONU" }, details: { en: "The United Nations was established on the ashes of World War II and the Holocaust. The horrors of the genocide forced the world to realize that state sovereignty could no longer justify the absolute impunity of governments treating their own populations. The UN Charter became the first step in building a new world order based on peace, security, and human rights.", it: "Le Nazioni Unite furono istituite sulle ceneri della Seconda Guerra Mondiale e dell'Olocausto. Gli orrori del genocidio costrinsero il mondo a capire che la sovranit√† statale non poteva pi√π giustificare l'assoluta impunit√† dei governi. La Carta ONU divenne il primo passo per costruire un nuovo ordine mondiale basato su pace, sicurezza e diritti umani." } },
            { year: 1950, label: { en: "Korean War", it: "Guerra di Corea" }, details: { en: "The first major proxy war of the Cold War era. It solidified the global division between the Western and Communist blocs, which would paralyze the UN Security Council for decades and split the human rights agenda into two competing camps: civil/political rights vs. economic/social rights.", it: "La prima grande guerra per procura dell'era della Guerra Fredda. Solidific√≤ la divisione globale tra blocchi occidentale e comunista, che paralizz√≤ il Consiglio di Sicurezza ONU per decenni e divise l'agenda dei diritti umani in due campi concorrenti: diritti civili/politici vs economici/sociali." } },
            { year: 1956, label: { en: "Hungarian Revolution", it: "Rivoluzione Ungherese" }, details: { en: "Soviet tanks crushed a spontaneous nationwide revolt against the government of the Hungarian People's Republic and its Soviet-imposed policies. This event highlighted the limitations of the UN to intervene in the Soviet sphere of influence and the hollowness of human rights rhetoric in the face of superpower geopolitics.", it: "I carri armati sovietici schiacciarono una rivolta spontanea contro il governo ungherese e le politiche imposte dai sovietici. L'evento evidenzi√≤ i limiti dell'ONU nell'intervenire nella sfera d'influenza sovietica e la vacuit√† della retorica sui diritti umani di fronte alla geopolitica delle superpotenze." } },
            { year: 1962, label: { en: "Cuban Missile Crisis", it: "Crisi dei Missili Cuba" }, details: { en: "The closest the world came to nuclear war. It dramatically underscored that the 'Right to Life' was fragile in the nuclear age. It spurred efforts towards disarmament, which was increasingly framed by developing nations as a necessary condition for the realization of human rights and development.", it: "Il momento pi√π vicino alla guerra nucleare. Sottoline√≤ drammaticamente che il 'Diritto alla Vita' era fragile nell'era nucleare. Stimol√≤ gli sforzi verso il disarmo, sempre pi√π inquadrato dalle nazioni in via di sviluppo come condizione necessaria per la realizzazione dei diritti umani." } },
            { year: 1968, label: { en: "Prague Spring / 68 Protests", it: "Primavera Praga / Proteste 68" }, details: { en: "A year of global upheaval. From the anti-Vietnam War protests in the US to the student movements in Paris and the suppression of reform in Czechoslovakia, citizens worldwide demanded greater civil liberties, peace, and accountability. It marked the emergence of a robust global civil society.", it: "Un anno di sconvolgimenti globali. Dalle proteste contro il Vietnam negli USA ai movimenti studenteschi a Parigi e alla soppressione delle riforme in Cecoslovacchia, i cittadini di tutto il mondo chiesero maggiori libert√† civili. Segn√≤ l'emergere di una robusta societ√† civile globale." } },
            { year: 1975, label: { en: "End of Vietnam War", it: "Fine Guerra Vietnam" }, details: { en: "The end of the war sparked a global anti-war movement and led to a period of reflection on the laws of war and the impact of conflict on civilians. It coincided with the Helsinki Accords, which legally linked recognition of European borders to respect for human rights, empowering dissidents in the Eastern Bloc.", it: "La fine della guerra scaten√≤ un movimento pacifista globale e port√≤ a una riflessione sulle leggi di guerra. Coincise con gli Accordi di Helsinki, che collegarono legalmente il riconoscimento dei confini europei al rispetto dei diritti umani, dando potere ai dissidenti nel Blocco Orientale." } },
            { year: 1985, label: { en: "USSR Reforms", it: "Riforme URSS" }, details: { en: "Mikhail Gorbachev initiated Glasnost (openness) and Perestroika (restructuring). These reforms loosened totalitarian control, allowing for greater freedom of speech and assembly in the Soviet Union. This thaw paved the way for the end of the Cold War and the subsequent unblocking of international human rights mechanisms.", it: "Gorbaciov avvi√≤ la Glasnost (trasparenza) e la Perestroika (ristrutturazione). Queste riforme allentarono il controllo totalitario, consentendo maggiore libert√† di parola in URSS. Questo disgelo apr√¨ la strada alla fine della Guerra Fredda e allo sblocco dei meccanismi internazionali." } },
            { year: 1989, label: { en: "Fall of Berlin Wall", it: "Caduta Muro di Berlino" }, details: { en: "Symbolizing the end of the Cold War, the fall of the Wall led to a surge in democratization in Eastern Europe. It ended the ideological gridlock at the UN, allowing for the ratification of major treaties (like the CRC) and the establishment of the Vienna consensus in 1993 regarding the universality of rights.", it: "Simbolo della fine della Guerra Fredda, la caduta del Muro port√≤ a un'ondata di democratizzazione nell'Est Europa. Pose fine al blocco ideologico all'ONU, consentendo la ratifica di importanti trattati (come la CRC) e il consenso di Vienna del 1993 sull'universalit√† dei diritti." } },
            { year: 1993, label: { en: "ICTY Established", it: "Istituzione ICTY" }, details: { en: "The UN Security Council established the International Criminal Tribunal for the former Yugoslavia. It was the first international war crimes court since Nuremberg, signaling that individual criminal responsibility for genocide and crimes against humanity would be enforced, ending the culture of impunity for leaders.", it: "Il Consiglio di Sicurezza istitu√¨ il Tribunale Penale Internazionale per l'ex Jugoslavia. Fu il primo tribunale internazionale per crimini di guerra da Norimberga, segnalando che la responsabilit√† penale individuale per genocidio sarebbe stata applicata, ponendo fine all'impunit√† per i leader." } },
            { year: 1994, label: { en: "Rwanda Genocide", it: "Genocidio Ruanda" }, details: { en: "The slaughter of 800,000 people in 100 days while the international community stood by was a catastrophic failure of the UN. It led to deep soul-searching regarding the 'duty to intervene' and eventually laid the conceptual groundwork for the 'Responsibility to Protect' (R2P) doctrine adopted in 2005.", it: "Il massacro di 800.000 persone in 100 giorni mentre la comunit√† internazionale restava a guardare fu un fallimento catastrofico dell'ONU. Port√≤ a una profonda riflessione sul 'dovere di intervenire' e gett√≤ le basi per la dottrina della 'Responsabilit√† di Proteggere' (R2P) adottata nel 2005." } },
            { year: 2001, label: { en: "September 11", it: "11 Settembre" }, details: { en: "The terrorist attacks in the US launched the 'War on Terror'. This era posed severe challenges to human rights, characterized by the use of extraordinary rendition, 'enhanced interrogation techniques' (torture), and indefinite detention (Guantanamo), testing the absolute nature of the ban on torture.", it: "Gli attacchi terroristici negli USA lanciarono la 'Guerra al Terrore'. Quest'era pose sfide severe ai diritti umani, caratterizzata da rendition straordinarie, 'tecniche di interrogatorio potenziate' (tortura) e detenzione indefinita, mettendo alla prova la natura assoluta del divieto di tortura." } },
            { year: 2006, label: { en: "HRC Created", it: "Creazione HRC" }, details: { en: "The UN Human Rights Council replaced the discredited Commission. It introduced the Universal Periodic Review (UPR), a unique mechanism whereby the human rights record of *every* UN member state is peer-reviewed every four years, ensuring no state is exempt from scrutiny.", it: "Il Consiglio per i Diritti Umani sostitu√¨ la screditata Commissione. Introdusse la Revisione Periodica Universale (UPR), un meccanismo unico in cui la situazione dei diritti umani di *ogni* stato membro viene esaminata dai pari ogni quattro anni, assicurando che nessuno stato sia esente." } },
            { year: 2015, label: { en: "Agenda 2030", it: "Agenda 2030" }, details: { en: "Adoption of the Sustainable Development Goals (SDGs). Unlike the previous MDGs, the SDGs explicitly ground development in human rights standards, aiming to 'leave no one behind'. It explicitly links poverty reduction with justice, gender equality, and strong institutions.", it: "Adozione degli Obiettivi di Sviluppo Sostenibile (SDG). A differenza dei precedenti MDG, gli SDG fondano esplicitamente lo sviluppo sugli standard dei diritti umani, mirando a 'non lasciare nessuno indietro'. Collega la riduzione della povert√† alla giustizia e all'uguaglianza di genere." } }
        ];

        const eras = [
            { name: {en: "Decolonization", it: "Decolonizzazione"}, start: 1945, end: 1975, color: "rgba(255, 165, 0, 0.15)", cssColor: "#FFA500", desc: { en: "A period defined by the rapid dismantling of European colonial empires in Africa and Asia. 'Self-Determination' evolved from a political aspiration to a binding legal right, becoming the prerequisite for the enjoyment of all other human rights. The Afro-Asian bloc began to reshape the UN agenda.", it: "Periodo definito dal rapido smantellamento degli imperi coloniali europei. L'Autodeterminazione evolse da aspirazione politica a diritto legale vincolante, divenendo prerequisito per tutti gli altri diritti. Il blocco Afro-Asiatico inizi√≤ a rimodellare l'agenda ONU." } },
            { name: {en: "Cold War", it: "Guerra Fredda"}, start: 1947, end: 1991, color: "rgba(0, 0, 255, 0.1)", cssColor: "#3182ce", desc: { en: "Global ideological polarization. The West championed Civil and Political Rights (Liberty), while the Soviet bloc championed Economic and Social Rights (Equality). This dichotomy caused the 'International Bill of Rights' to be split into two separate covenants (ICCPR and ICESCR) rather than one unified treaty.", it: "Polarizzazione ideologica globale. L'Occidente sosteneva i Diritti Civili e Politici (Libert√†), il blocco Sovietico quelli Economici e Sociali (Uguaglianza). Questa dicotomia caus√≤ la scissione della 'Carta dei Diritti' in due patti separati (ICCPR e ICESCR)." } },
            { name: {en: "US Unipolar", it: "Unipolarismo USA"}, start: 1991, end: 2001, color: "rgba(128, 0, 128, 0.1)", cssColor: "#805ad5", desc: { en: "Following the collapse of the USSR, liberal democracy and human rights expanded globally. This decade saw the establishment of international criminal tribunals and the 'responsibility to protect' concept, aiming to enforce rights over sovereignty.", it: "Dopo il crollo dell'URSS, democrazia liberale e diritti umani si espansero. Questo decennio vide l'istituzione di tribunali penali internazionali e il concetto di 'responsabilit√† di proteggere', mirando a far valere i diritti sopra la sovranit√†." } },
            { name: {en: "War on Terror", it: "Guerra al Terrore"}, start: 2001, end: 2025, color: "rgba(50, 50, 50, 0.1)", cssColor: "#4a5568", desc: { en: "Triggered by 9/11, this era saw a tension between national security and individual liberties. While new rights emerged (digital, environmental), traditional prohibitions against torture and surveillance were severely tested.", it: "Innescata dall'11 settembre, quest'era ha visto una tensione tra sicurezza nazionale e libert√† individuali. Mentre emergevano nuovi diritti (digitali, ambientali), i divieti tradizionali contro tortura e sorveglianza sono stati messi a dura prova." } }
        ];

        // --- UPDATED SECRETARY GENERALS DATA WITH EXPANDED DESCRIPTIONS ---
        const unSecretaries = [
            { name: "Trygve Lie", start: 1946, end: 1952, color: "#cbd5e0", 
              desc: { en: "First Secretary-General, he oversaw the establishment of the UN's physical and administrative infrastructure. He supported the drafting of the Universal Declaration of Human Rights. His tenure was cut short by the Cold War; he was eventually boycotted by the Soviet Union due to his support for UN intervention in the Korean War.", it: "Primo Segretario Generale, supervision√≤ la creazione dell'infrastruttura ONU. Sostenne la stesura della Dichiarazione Universale. Il suo mandato fu accorciato dalla Guerra Fredda; fu boicottato dall'Unione Sovietica per il suo sostegno all'intervento ONU in Corea." } },
            
            { name: "Dag Hammarskj√∂ld", start: 1953, end: 1961, color: "#a0aec0", 
              desc: { en: "Widely considered the most effective SG, he invented 'preventive diplomacy' and UN Peacekeeping ('Blue Helmets'). He championed the independence of the civil service and supported decolonization. He died mysteriously in a plane crash in Northern Rhodesia (Zambia) while on a peace mission to the Congo. Posthumously awarded the Nobel Peace Prize.", it: "Considerato il SG pi√π efficace, invent√≤ la 'diplomazia preventiva' e il Peacekeeping ONU ('Caschi Blu'). Difese l'indipendenza della funzione pubblica e sostenne la decolonizzazione. Mor√¨ misteriosamente in un incidente aereo in Congo. Premio Nobel per la Pace postumo." } },
            
            { name: "U Thant", start: 1961, end: 1971, color: "#cbd5e0", 
              desc: { en: "The first non-European SG (Burma), he led the UN during the Cuban Missile Crisis and the Six-Day War. He quietly oversaw the negotiations that led to the completion of the two 1966 Covenants (ICCPR & ICESCR). He was a vocal critic of the Apartheid regime in South Africa and the Vietnam War.", it: "Primo SG non europeo (Birmania), guid√≤ l'ONU durante la crisi di Cuba e la Guerra dei Sei Giorni. Supervision√≤ i negoziati per i Patti del 1966. Fu un critico accanito dell'Apartheid in Sudafrica e della guerra in Vietnam." } },
            
            { name: "Kurt Waldheim", start: 1972, end: 1981, color: "#a0aec0", 
              desc: { en: "His tenure was marked by the stagnation of the Cold War d√©tente. While he oversaw the first World Conference on Women (1975), his legacy was later tarnished by revelations of his hidden wartime service in the Wehrmacht during WWII. His effectiveness in human rights was limited by the geopolitical gridlock.", it: "Il suo mandato fu segnato dalla stagnazione della distensione. Sebbene supervision√≤ la prima Conferenza sulle Donne (1975), la sua eredit√† fu macchiata dalle rivelazioni sul suo servizio nella Wehrmacht. La sua efficacia sui diritti umani fu limitata dal blocco geopolitico." } },
            
            { name: "Javier P√©rez de Cu√©llar", start: 1982, end: 1991, color: "#cbd5e0", 
              desc: { en: "A skilled Peruvian diplomat, he presided over the end of the Cold War. He played a crucial role in mediating the end of the Iran-Iraq War and the independence of Namibia. Under his tenure, the Convention on the Rights of the Child was adopted, and he helped rebuild the UN's reputation as a peacemaker.", it: "Abile diplomatico peruviano, presiedette la fine della Guerra Fredda. Ebbe un ruolo cruciale nella fine della guerra Iran-Iraq e nell'indipendenza della Namibia. Sotto il suo mandato fu adottata la Convenzione sui Bambini e aiut√≤ a ricostruire la reputazione dell'ONU." } },
            
            { name: "Boutros Boutros-Ghali", start: 1992, end: 1996, color: "#a0aec0", 
              desc: { en: "His 'Agenda for Peace' sought to redefine UN intervention in the post-Cold War era. He led the UN during the Vienna World Conference (1993) which affirmed the universality of rights. However, his tenure was marred by the UN's catastrophic failure to prevent the Rwandan Genocide and the Srebrenica massacre.", it: "La sua 'Agenda per la Pace' cerc√≤ di ridefinire l'intervento ONU post-Guerra Fredda. Guid√≤ l'ONU durante la Conferenza di Vienna (1993). Tuttavia, il suo mandato fu segnato dal catastrofico fallimento nel prevenire il genocidio in Ruanda e il massacro di Srebrenica." } },
            
            { name: "Kofi Annan", start: 1997, end: 2006, color: "#e2e8f0", 
              desc: { en: "A Nobel Peace Prize laureate, he renewed the UN's focus on human rights, famously stating that sovereignty is not a shield for abuse. He championed the 'Responsibility to Protect' (R2P) doctrine and established the Millennium Development Goals (MDGs). He pushed for the replacement of the discredited Human Rights Commission with the Human Rights Council.", it: "Premio Nobel per la Pace, rinnov√≤ l'attenzione sui diritti umani, affermando che la sovranit√† non √® uno scudo per gli abusi. Promosse la dottrina della 'Responsabilit√† di Proteggere' (R2P) e istitu√¨ gli Obiettivi del Millennio. Spinse per sostituire la screditata Commissione con il Consiglio Diritti Umani." } },
            
            { name: "Ban Ki-moon", start: 2007, end: 2016, color: "#a0aec0", 
              desc: { en: "He launched the 'Human Rights Up Front' initiative to ensure the UN prioritizes rights in all its activities. He was a strong advocate for LGBT rights ('Love is a human right') and gender equality, establishing UN Women. His crowning achievement was the Paris Climate Agreement, linking climate change inextricably to human survival.", it: "Lanci√≤ l'iniziativa 'Human Rights Up Front' per dare priorit√† ai diritti. Fu un forte sostenitore dei diritti LGBT ('L'amore √® un diritto umano') e dell'uguaglianza di genere, istituendo UN Women. Il suo successo principale fu l'Accordo di Parigi, legando il clima alla sopravvivenza umana." } },
            
            { name: "Ant√≥nio Guterres", start: 2017, end: 2026, color: "#cbd5e0", 
              desc: { en: "Operating in a polarized world, he launched the 'Call to Action for Human Rights'. He focuses heavily on the 'triple planetary crisis' (climate, pollution, biodiversity) as a massive human rights threat. He has also been vocal about the risks of new technologies (AI, autonomous weapons) and the shrinking space for civil society globally.", it: "Operando in un mondo polarizzato, ha lanciato la 'Call to Action per i Diritti Umani'. Si concentra pesantemente sulla 'tripla crisi planetaria' (clima, inquinamento, biodiversit√†) come minaccia ai diritti. √à stato esplicito sui rischi delle nuove tecnologie e sulla riduzione dello spazio per la societ√† civile." } }
        ];

        // --- HELPER FUNCTIONS ---

        function getTrans(obj) {
            if (obj && obj[currentLang]) return obj[currentLang];
            return obj['en'] || obj; 
        }

        function parseText(text) {
            if(!text) return "";
            let parsed = text.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>');
            parsed = parsed.replace(/\*(.*?)\*/g, '<i>$1</i>');
            return parsed;
        }

        // --- PAGE SWITCHING ---
        function switchPage(pageId) {
            // Nascondi tutto
            document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            
            // Logica per le pagine
            if(pageId === 'intro') {
                document.getElementById('intro-page').classList.add('active');
                document.getElementById('nav-intro').classList.add('active');
                document.getElementById('ui-controls').style.display = 'none'; 

            } else if (pageId === 'timeline') {
                document.getElementById('timeline-page').classList.add('active');
                document.getElementById('nav-timeline').classList.add('active');
                document.getElementById('ui-controls').style.display = 'flex';
                
                draw(); // Disegna timeline
                
                // Lancia tutorial solo se siamo in timeline
                setTimeout(() => { if (typeof startUITutorial === "function") startUITutorial(); }, 500);

            } else if (pageId === 'stats') {
                // NUOVA PAGINA STATISTICHE
                document.getElementById('stats-page').classList.add('active');
                document.getElementById('nav-stats').classList.add('active');
                document.getElementById('ui-controls').style.display = 'none'; // Nascondi controlli timeline
                
                // Disegna i grafici (con un piccolo ritardo per assicurarsi che il DOM sia pronto)
                setTimeout(() => { renderCharts(); }, 100);
            }
        }

        function updateStaticText() {
            // Legend & Title
            document.getElementById('legend-title-text').innerText = dict[currentLang].legend_title;
            document.querySelectorAll('[data-key]').forEach(el => {
                const k = el.getAttribute('data-key');
                if(dict[currentLang][k]) el.innerText = dict[currentLang][k];
            });
            
            // Aggiorna istruzioni legenda
            const instrContainer = document.getElementById('legend-instr-content');
            instrContainer.innerHTML = '';
            dict[currentLang].instr.forEach(txt => {
                const span = document.createElement('span');
                span.innerHTML = txt;
                instrContainer.appendChild(span);
            });
            
            // Buttons UI
            document.getElementById('lang-btn').innerText = currentLang === 'en' ? 'EN' : 'IT';
            document.getElementById('tour-prev').innerText = dict[currentLang].tour_prev;
            document.getElementById('tour-next').innerText = dict[currentLang].tour_next;
            document.getElementById('tour-exit').innerText = dict[currentLang].tour_exit;

            // Navigazione
            document.getElementById('nav-intro').innerText = dict[currentLang].nav_intro;
            document.getElementById('nav-timeline').innerText = dict[currentLang].nav_timeline;
            document.getElementById('nav-stats').innerText = dict[currentLang].nav_stats; // NUOVO

            // Intro Page
            document.querySelector('#intro-uni-sub-1').innerText = dict[currentLang].uni_sub_1;
            document.querySelector('#intro-uni-sub-2').innerText = dict[currentLang].uni_sub_2;
            document.querySelector('#intro-main-title').innerText = dict[currentLang].project_title;
            document.querySelector('#intro-author-prefix').innerText = dict[currentLang].author_prefix;
            document.querySelector('#intro-title-1').innerText = dict[currentLang].intro_title;
            document.querySelector('#intro-text-1').innerText = dict[currentLang].intro_text_1;
            document.querySelector('#intro-text-2').innerText = dict[currentLang].intro_text_2;
            document.querySelector('#intro-btn').innerText = dict[currentLang].timeline_btn;

            // --- NUOVA PAGINA STATISTICHE ---
            document.getElementById('stat-main-title').innerText = dict[currentLang].stat_title;
            document.getElementById('stat-main-sub').innerText = dict[currentLang].stat_sub;
            document.getElementById('stat-card1-title').innerText = dict[currentLang].stat_c1_title;
            document.getElementById('stat-card1-desc').innerText = dict[currentLang].stat_c1_desc;
            document.getElementById('stat-card2-title').innerText = dict[currentLang].stat_c2_title;
            document.getElementById('stat-card2-desc').innerText = dict[currentLang].stat_c2_desc;
            document.getElementById('stat-back-btn').innerText = dict[currentLang].stat_back;
            
            // Se siamo nella pagina stats, rigenera i grafici per aggiornare le etichette interne
            if (document.getElementById('stats-page').classList.contains('active')) {
                renderCharts();
            }
        }

        function toggleLanguage() {
            currentLang = currentLang === 'en' ? 'it' : 'en';
            updateStaticText();
            container.innerHTML = '<svg id="lines"></svg>'; 
            svg = document.getElementById('lines');
            activeLeafId = null;
            draw();
        }

        // --- TOUR LOGIC ---
        let activeTour = false;
        let currentTourStep = 0;
        const tourSteps = [
            "unc", "udhr", "ICERD", "iccpr", "icescr", "CEDAW", "CAT", "CRC", "A_CONF.157_23", "CRPD", "node_23", "A_RES_76_300"
        ];

        function startTour() {
            activeTour = true;
            currentTourStep = 0;
            document.getElementById('tour-controls').classList.add('active');
            updateTourUI();
            goToStep(currentTourStep);
        }

        function endTour() {
            activeTour = false;
            document.getElementById('tour-controls').classList.remove('active');
            resetHighlight();
        }

        function nextStep() {
            if(currentTourStep < tourSteps.length - 1) {
                currentTourStep++;
                goToStep(currentTourStep);
            } else {
                endTour();
            }
        }

        function prevStep() {
            if(currentTourStep > 0) {
                currentTourStep--;
                goToStep(currentTourStep);
            }
        }

        function updateTourUI() {
            document.getElementById('tour-current').innerText = currentTourStep + 1;
            document.getElementById('tour-total').innerText = tourSteps.length;
        }

        function goToStep(index) {
            updateTourUI();
            const nodeId = tourSteps[index];
            const node = document.querySelector(`.node[data-id="${nodeId}"]`);
            if(node) {
                const absoluteLeft = parseFloat(node.style.left);
                const scrollX = absoluteLeft - (window.innerWidth / 2) + (parseFloat(node.style.width || 70) / 2);
                viewport.scrollTo({ left: scrollX, behavior: 'smooth' });

                if(!node.classList.contains('expanded')) {
                    node.click();
                } else {
                    highlightPath(nodeId);
                }
            }
        }

        function toggleLegend() {
            document.getElementById('legend').classList.toggle('collapsed');
        }

        function getRatifyingCountries(count) {
             const allCountries = ["Afghanistan","Albania","Algeria","Andorra","Angola","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bhutan","Bolivia","Bosnia","Botswana","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Cabo Verde","Cambodia","Cameroon","Canada","Chad","Chile","China","Colombia","Comoros","Congo","Costa Rica","Croatia","Cuba","Cyprus","Czechia","Denmark","Djibouti","Dominica","Ecuador","Egypt","El Salvador","Estonia","Eswatini","Ethiopia","Fiji","Finland","France","Gabon","Gambia","Georgia","Germany","Ghana","Greece","Grenada","Guatemala","Guinea","Guyana","Haiti","Honduras","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Mauritania","Mauritius","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","New Zealand","Nicaragua","Niger","Nigeria","North Macedonia","Norway","Oman","Pakistan","Palau","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russia","Rwanda","Samoa","San Marino","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Sweden","Switzerland","Syria","Tajikistan","Tanzania","Thailand","Timor-Leste","Togo","Tonga","Trinidad","Tunisia","Turkey","Turkmenistan","Tuvalu","Uganda","Ukraine","UAE","UK","USA","Uruguay","Uzbekistan","Vanuatu","Venezuela","Vietnam","Yemen","Zambia","Zimbabwe"];
            const list = allCountries.slice(0, count);
            let html = "<ul>";
            list.forEach(c => html += `<li>${c}</li>`);
            html += "</ul>";
            return html;
        }

        const container = document.getElementById('chart-container');
        const viewport = document.getElementById('viewport');
        let svg = document.getElementById('lines');
        
        let activeLeafId = null;
        let currentZoom = 1;
        const CFG = {
            startYear: 1940,
            pxPerYear: 65,
            centerY: 350,
            wMain: 70, hMain: 34, sizeMinor: 14, yScale: 1.6 
        };

        function changeZoom(delta) {
            currentZoom += delta;
            if(currentZoom < 0.5) currentZoom = 0.5;
            if(currentZoom > 2.0) currentZoom = 2.0;
            container.style.transform = `scale(${currentZoom})`;
        }

        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
        }

        function drawCrossReference(startId, targetId, isPersistent = false) {
            const startNode = document.querySelector(`.node[data-id="${startId}"]`);
            const endNode = document.querySelector(`.node[data-id="${targetId}"]`);
            
            if(!startNode || !endNode) return;

            const x1 = parseFloat(startNode.style.left) + (startNode.classList.contains('type-main') ? 35 : 7);
            const y1 = parseFloat(startNode.style.top) + (startNode.classList.contains('type-main') ? 17 : 7);
            const x2 = parseFloat(endNode.style.left) + (endNode.classList.contains('type-main') ? 35 : 7);
            const y2 = parseFloat(endNode.style.top) + (endNode.classList.contains('type-main') ? 17 : 7);

            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
            const mx = (x1 + x2) / 2;
            const my = (y1 + y2) / 2 - 50; 
            path.setAttribute("d", `M ${x1} ${y1} Q ${mx} ${my} ${x2} ${y2}`);
            path.setAttribute("stroke", "#718096");
            path.setAttribute("stroke-width", "2");
            path.setAttribute("fill", "none");
            
            path.setAttribute("class", isPersistent ? "cross-ref-line perm-ref" : "cross-ref-line temp-ref");
            svg.appendChild(path);
        }

        function removeCrossReferences() {
            document.querySelectorAll('.temp-ref').forEach(el => el.remove());
        }

        function getSubtype(label) {
            const l = label.toLowerCase();
            if (l.includes("convention") || l.includes("covenant") || l.includes("charter") || l.includes("convenzione") || l.includes("patto") || l.includes("carta")) return "subtype-conv";
            if (l.includes("declaration") || l.includes("dichiarazione")) return "subtype-decl";
            return "subtype-other";
        }

        function createPath(d, color, targetId) {
            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
            path.setAttribute("d", d);
            path.setAttribute("stroke", color); path.setAttribute("fill", "none");
            path.setAttribute("stroke-width", "1.5"); path.setAttribute("opacity", "0.7");
            path.setAttribute("data-target-id", targetId);
            svg.appendChild(path);
        }

        function highlightPath(nodeId) {
            if (activeLeafId === nodeId) { resetHighlight(); return; }
            activeLeafId = nodeId;
            const pathIds = new Set();
            let curr = data.find(d => d.id === nodeId);
            while(curr) { pathIds.add(curr.id); curr = data.find(d => d.id === curr.parent); }
            document.querySelectorAll('.node').forEach(el => {
                if (pathIds.has(el.dataset.id)) { el.classList.remove('dimmed'); } 
                else { 
                    el.classList.add('dimmed'); 
                    el.classList.remove('expanded'); 
                    el.style.transform = ''; 
                }
            });
            document.querySelectorAll('svg path').forEach(el => {
                if(el.classList.contains('cross-ref-line')) return; 
                const tid = el.getAttribute('data-target-id');
                if (pathIds.has(tid)) { el.classList.remove('dimmed'); el.classList.add('highlighted-path'); } 
                else { el.classList.add('dimmed'); el.classList.remove('highlighted-path'); }
            });
            document.querySelectorAll('.bg-event-label, .bg-event-line').forEach(el => el.classList.add('dimmed'));
        }

        function resetHighlight() {
            activeLeafId = null;
            document.querySelectorAll('.dimmed').forEach(el => el.classList.remove('dimmed'));
            document.querySelectorAll('.highlighted-path').forEach(el => el.classList.remove('highlighted-path'));
            document.querySelectorAll('.node.expanded').forEach(el => {
                el.classList.remove('expanded');
                el.style.transform = ''; 
            });
            
            // Close any open drawers
            document.querySelectorAll('.sg-block.expanded-drawer').forEach(el => el.classList.remove('expanded-drawer'));

            document.querySelectorAll('.perm-ref').forEach(el => el.remove()); 
            removeCrossReferences();
        }

        function drawEras() {
            const boundaries = new Set([CFG.startYear]);
            eras.forEach(e => { if(e.start >= CFG.startYear) boundaries.add(e.start); if(e.end >= CFG.startYear) boundaries.add(e.end); });
            const sortedBounds = Array.from(boundaries).sort((a,b) => a - b);
            for (let i = 0; i < sortedBounds.length - 1; i++) {
                const startY = sortedBounds[i]; const endY = sortedBounds[i+1];
                const activeEras = eras.filter(e => e.start < endY && e.end > startY);
                if (activeEras.length > 0) {
                    const x = (startY - CFG.startYear) * CFG.pxPerYear;
                    const width = (endY - startY) * CFG.pxPerYear;
                    const block = document.createElement('div');
                    block.className = 'era-block'; block.style.left = x + 'px'; block.style.width = width + 'px';
                    if (activeEras.length === 1) { block.style.backgroundColor = activeEras[0].color; } 
                    else {
                        const c1 = activeEras[0].cssColor + '20'; const c2 = activeEras[1].cssColor + '20';
                        block.style.background = `repeating-linear-gradient(-45deg, ${c1}, ${c1} 10px, ${c2} 10px, ${c2} 20px)`;
                    }
                    
                    activeEras.forEach((era, idx) => {
                        const label = document.createElement('div'); 
                        label.className = 'era-label-bg'; 
                        label.innerText = getTrans(era.name);
                        if(activeEras.length > 1) {
                            if(idx % 2 === 0) label.classList.add('era-pos-top');
                            else label.classList.add('era-pos-bot');
                        }
                        block.appendChild(label);
                    });

                    block.addEventListener('click', (e) => {
                        const expandedNode = document.querySelector('.node.expanded');
                        const isPathActive = activeLeafId !== null;
                        const isPopoverOpen = document.querySelector('.hist-popover.active');
                        // Also check drawers
                        const isDrawerOpen = document.querySelector('.sg-block.expanded-drawer');

                        if (expandedNode || isPathActive || isPopoverOpen || isDrawerOpen) return; 
                        e.stopPropagation();
                        document.querySelectorAll('.hist-popover.active').forEach(p => p.classList.remove('active'));
                        const popover = document.createElement('div');
                        popover.className = 'hist-popover active';
                        popover.style.left = (e.pageX - container.getBoundingClientRect().left + 10) + 'px'; popover.style.top = '100px'; 
                        let content = `<div class="close-btn" onclick="this.parentElement.remove(); event.stopPropagation();">√ó</div>`;
                        content += `<h4>${dict[currentLang].hist_ctx} (${startY} - ${endY})</h4>`;
                        activeEras.forEach(era => { content += `<div style="margin-bottom:15px; border-bottom:1px solid #eee; padding-bottom:10px;"><strong style="color:${era.cssColor}; font-size:14px;">${getTrans(era.name)}</strong><br><p style="margin-top:5px;">${parseText(getTrans(era.desc))}</p></div>`; });
                        popover.innerHTML = content; container.appendChild(popover);
                    });
                    container.insertBefore(block, svg);
                }
            }
        }

        // --- DRAW SECRETARIES (NEW DRAWER STYLE) ---
        function drawSecretaries() {
            unSecretaries.forEach(sg => {
                if (sg.end < CFG.startYear) return;
                
                const startY = Math.max(sg.start, CFG.startYear);
                const x = (startY - CFG.startYear) * CFG.pxPerYear;
                const width = (sg.end - startY) * CFG.pxPerYear;
                
                const sgBlock = document.createElement('div');
                sgBlock.className = 'sg-block';
                sgBlock.style.left = x + 'px';
                sgBlock.style.width = width + 'px';
                sgBlock.style.backgroundColor = sg.color;
                
                const roleText = currentLang === 'en' ? "UN Secretary-General" : "Segretario Generale ONU";

                // Build HTML inside the block (Label + Hidden Content)
                sgBlock.innerHTML = `
                    <div class="sg-label-static">${sg.name}</div>
                    <div class="sg-content-inner">
                        <div class="sg-close-btn" onclick="event.stopPropagation(); this.closest('.sg-block').classList.remove('expanded-drawer');">√ó</div>
                        <h4>${sg.name} (${sg.start}-${sg.end})</h4>
                        <p><strong>${roleText}</strong></p>
                        <p>${parseText(getTrans(sg.desc))}</p>
                    </div>
                `;

                // Click event: Toggle Drawer Class
                sgBlock.addEventListener('click', (e) => {
                    e.stopPropagation();
                    // Close popovers
                    document.querySelectorAll('.hist-popover.active').forEach(p => p.classList.remove('active'));
                    // Close other drawers
                    document.querySelectorAll('.sg-block.expanded-drawer').forEach(b => {
                        if(b !== sgBlock) b.classList.remove('expanded-drawer');
                    });
                    
                    sgBlock.classList.toggle('expanded-drawer');
                });

                container.appendChild(sgBlock);
            });
        }

        function draw() {
            const mainNodeYears = new Set(data.filter(d => d.type === 'main').map(d => d.year));
            drawEras();
            
            // Draw Axis
            for (let y = 1940; y <= 2030; y += 5) {
                if (mainNodeYears.has(y)) continue; 
                const x = (y - CFG.startYear) * CFG.pxPerYear;
                const lT = document.createElement('div'); lT.className = 'axis-label axis-top'; lT.style.left = x+'px'; lT.innerText = y; container.appendChild(lT);
                const lB = document.createElement('div'); lB.className = 'axis-label axis-bot'; lB.style.left = x+'px'; lB.innerText = y; container.appendChild(lB);
            }

            drawSecretaries();

            history.forEach(evt => {
                const x = (evt.year - CFG.startYear) * CFG.pxPerYear;
                const line = document.createElement('div'); line.className = 'bg-event-line'; line.style.left = x+'px';
                const label = document.createElement('div'); label.className = 'bg-event-label'; label.style.left = x+'px'; label.innerText = getTrans(evt.label);
                const popover = document.createElement('div'); popover.className = 'hist-popover'; popover.style.left = (x + 10) + 'px'; 
                popover.innerHTML = `<div class="close-btn" onclick="this.parentElement.classList.remove('active'); event.stopPropagation();">√ó</div><h4>${getTrans(evt.label)} (${evt.year})</h4><p>${parseText(getTrans(evt.details))}</p>`;
                label.addEventListener('click', function(e) { e.stopPropagation(); document.querySelectorAll('.hist-popover.active').forEach(p => p.classList.remove('active')); popover.classList.add('active'); });
                container.appendChild(line); container.appendChild(label); container.appendChild(popover);
            });

            data.forEach(item => {
                const x = (item.year - CFG.startYear) * CFG.pxPerYear;
                const y = CFG.centerY - (item.y * CFG.yScale);
                const color = colorMap[item.class];
                const isMinor = item.type === 'minor';
                const labelText = getTrans(item.label);
                const descText = parseText(getTrans(item.desc));
                const subtypeClass = isMinor ? '' : getSubtype(labelText);

                if (!isMinor) {
                    const guideLine = document.createElement('div'); guideLine.className = 'year-guideline'; guideLine.style.left = (x + CFG.wMain/2) + 'px'; 
                    const guideLabelBot = document.createElement('div'); guideLabelBot.className = 'year-guideline-label bot'; guideLabelBot.innerText = item.year; guideLine.appendChild(guideLabelBot);
                    const guideLabelTop = document.createElement('div'); guideLabelTop.className = 'year-guideline-label top'; guideLabelTop.innerText = item.year; guideLine.appendChild(guideLabelTop);
                    container.appendChild(guideLine);
                }

                const div = document.createElement('div');
                div.className = `node ${isMinor ? 'type-minor' : 'type-main'} ${item.class} ${subtypeClass}`;
                div.style.left = x + 'px'; div.dataset.id = item.id;
                const height = isMinor ? CFG.sizeMinor : CFG.hMain;
                div.style.top = (y - (height / 2)) + 'px';
                if(isMinor) { div.style.borderColor = color; } else { div.style.borderLeftColor = color; }

                let contentHTML = `
                    <div class="sigla">${item.sigla || ''}</div>
                    <div class="extended-content">
                        <div class="close-btn" onclick="this.parentElement.parentElement.classList.remove('expanded'); this.parentElement.parentElement.style.transform = ''; event.stopPropagation();">√ó</div>
                        <div class="info-line">${isMinor ? dict[currentLang].step_label : item.sigla} | ${item.year}</div>
                        <h3>${labelText}</h3>
                        <div class="description">${descText}</div>
                `;

                if(item.ratifications) {
                    const pct = (item.ratifications / 193) * 100;
                    let barColor = 'var(--status-high)';
                    if(item.ratifications < 100) barColor = 'var(--status-low)';
                    else if(item.ratifications < 160) barColor = 'var(--status-mid)';

                    contentHTML += `
                        <div class="ratification-container">
                            <strong>${dict[currentLang].rat_label}</strong> ${item.ratifications} / 193 ${dict[currentLang].rat_states}
                            <div class="progress-track"><div class="progress-fill" style="width:${pct}%; background:${barColor}"></div></div>
                            <details>
                                <summary>${dict[currentLang].view_countries}</summary>
                                <div class="country-list-box">${getRatifyingCountries(item.ratifications)}</div>
                            </details>
                        </div>
                    `;
                }

                if(item.link) { contentHTML += `<a href="${item.link}" target="_blank" class="doc-link-btn">${dict[currentLang].read_text}</a>`; }
                contentHTML += `</div>`; 
                div.innerHTML = contentHTML;

                div.addEventListener('click', function(e) {
                    e.stopPropagation(); 
                    document.querySelectorAll('.hist-popover.active').forEach(p => p.classList.remove('active')); 
                    highlightPath(item.id);
                    
                    document.querySelectorAll('.node.expanded').forEach(n => {
                        if(n !== this) {
                            n.classList.remove('expanded');
                            n.style.transform = ''; 
                        }
                    });
                    
                    this.classList.toggle('expanded');

                    if(this.classList.contains('expanded')) {
                        if (item.y < -30) {
                            this.style.transformOrigin = 'center bottom';
                            this.style.transform = 'translateY(calc(-100% + 40px))';
                        } else {
                            this.style.transformOrigin = 'center top';
                            this.style.transform = 'translateY(-10px)'; 
                        }
                    } else {
                        this.style.transform = '';
                    }

                    document.querySelectorAll('.perm-ref').forEach(el => el.remove()); 
                    if(this.classList.contains('expanded') && item.related) {
                        item.related.forEach(targetId => drawCrossReference(item.id, targetId, true));
                    }
                });

                div.addEventListener('mouseenter', function() {
                    if(!this.classList.contains('expanded') && item.related) { 
                        item.related.forEach(targetId => drawCrossReference(item.id, targetId, false)); 
                    }
                });
                div.addEventListener('mouseleave', function() { removeCrossReferences(); });

                container.appendChild(div);

                if (item.parent) {
                    const parent = data.find(d => d.id === item.parent);
                    if (parent) {
                        const px = (parent.year - CFG.startYear) * CFG.pxPerYear; const py = CFG.centerY - (parent.y * CFG.yScale); 
                        const startOffset = parent.type === 'minor' ? CFG.sizeMinor : CFG.wMain;
                        const xStart = px + startOffset; const yStart = py; const xEnd = x; const yEnd = y;
                        if (item.class === parent.class) {
                            const xMid = xStart + (xEnd - xStart) / 2; createPath(`M ${xStart} ${yStart} L ${xMid} ${yStart} L ${xMid} ${yEnd} L ${xEnd} ${yEnd}`, color, item.id);
                        } else {
                            const elbowSpace = 25; let xMid = xEnd - elbowSpace; if (xMid < xStart) xMid = xStart + 10; 
                            const parentColor = colorMap[parent.class];
                            createPath(`M ${xStart} ${yStart} L ${xMid} ${yStart}`, parentColor, item.id); createPath(`M ${xMid} ${yStart} L ${xMid} ${yEnd} L ${xEnd} ${yEnd}`, color, item.id);
                        }
                    }
                }
            });
        }

        document.getElementById('viewport').addEventListener('click', function() {
            resetHighlight();
            document.querySelectorAll('.hist-popover.active').forEach(p => p.classList.remove('active'));
        });

        viewport.addEventListener('wheel', (evt) => {
            if(evt.target.closest('.country-list-box')) return;
            if (evt.ctrlKey) { evt.preventDefault(); changeZoom(evt.deltaY > 0 ? -0.1 : 0.1); } 
            else { evt.preventDefault(); viewport.scrollLeft += evt.deltaY; }
        });

        // Initialize with default language
        switchPage('intro'); // Start on intro page
        updateStaticText();
        // --- UI TUTORIAL LOGIC ---
        let uiTourIndex = 0;
        
        // Definizione dei passaggi del tutorial
        // Definizione dei passaggi del tutorial (AGGIORNATA CON RICERCA)
        const uiTourSteps = [
            {
                target: null, // null = centro schermo
                title: { en: "Welcome to the Timeline", it: "Benvenuti nella Timeline" },
                text: { 
                    en: "This interactive tool maps the evolution of human rights. Let's take a quick look at how to navigate.", 
                    it: "Questo strumento interattivo mappa l'evoluzione dei diritti umani. Diamo una rapida occhiata a come navigare." 
                }
            },
            {
                target: ".search-wrapper", // NUOVO STEP: Punta alla barra di ricerca
                title: { en: "Smart Search", it: "Ricerca Intelligente" },
                text: { 
                    en: "Looking for a specific treaty, topic, or year? Type here (e.g., 'Torture', '1989') to filter the view. The timeline will auto-scroll to the first result.", 
                    it: "Cerchi un trattato, un tema o un anno specifico? Scrivi qui (es. 'Tortura', '1989') per filtrare la vista. La timeline scorrer√† automaticamente al primo risultato." 
                }
            },
            {
                target: "#legend", 
                title: { en: "The Legend", it: "La Legenda" },
                text: { 
                    en: "Here you can filter the different branches of rights (Civil, Social, etc.) and understand the symbols used.", 
                    it: "Qui puoi filtrare i diversi rami dei diritti (Civili, Sociali, ecc.) e capire i simboli utilizzati." 
                }
            },
            {
                target: "#viewport", // Evidenzia l'area principale
                title: { en: "Navigation", it: "Navigazione" },
                text: { 
                    en: "Scroll horizontally (mouse wheel or drag) to move through time. Click on the background to see historical context for that era.", 
                    it: "Scorri orizzontalmente (rotella o trascinamento) per muoverti nel tempo. Clicca sullo sfondo per vedere il contesto storico dell'epoca." 
                }
            },
            {
                target: ".sg-block", // Punta al primo blocco SG
                title: { en: "Secretary Generals", it: "Segretari Generali" },
                text: { 
                    en: "These bars at the bottom represent the UN mandate periods. Click them to reveal details about each Secretary-General.", 
                    it: "Queste barre in basso rappresentano i mandati ONU. Cliccale per rivelare dettagli su ogni Segretario Generale." 
                }
            },
            {
                target: "#ui-controls", 
                title: { en: "Zoom & Tools", it: "Zoom e Strumenti" },
                text: { 
                    en: "Use these buttons to Zoom In/Out. The üéì hat icon starts a guided historical tour of key events.", 
                    it: "Usa questi pulsanti per lo Zoom. L'icona üéì avvia un tour storico guidato degli eventi chiave." 
                }
            }
        ];

        function startUITutorial(force = false) {
            // Se NON stiamo forzando l'avvio (es. click bottone) 
            // E l'utente l'ha gi√† visto in passato -> Esci e non fare nulla
            if (!force && localStorage.getItem('tutorialSeen_v1')) return;

            document.getElementById('tutorial-overlay').style.display = 'block';
            uiTourIndex = 0;
            
            // Necessario per assicurarsi che la card abbia le dimensioni giuste prima di calcolare la posizione
            // (a volte il browser √® lento a renderizzare il display:block)
            setTimeout(() => {
                renderUITourStep();
            }, 10);
        }

        function endUITutorial(save) {
            document.getElementById('tutorial-overlay').style.display = 'none';
            if(save) {
                localStorage.setItem('tutorialSeen_v1', 'true');
            }
        }

        function nextUITutorialStep() {
            uiTourIndex++;
            if(uiTourIndex >= uiTourSteps.length) {
                endUITutorial(true);
            } else {
                renderUITourStep();
            }
        }

        function renderUITourStep() {
            const step = uiTourSteps[uiTourIndex];
            const spotlight = document.getElementById('tut-spotlight');
            const card = document.getElementById('tut-card');
            
            // 1. Aggiorna i Testi (supporta il cambio lingua immediato)
            document.getElementById('tut-title').innerText = getTrans(step.title);
            document.getElementById('tut-desc').innerText = getTrans(step.text);
            document.getElementById('tut-step-curr').innerText = uiTourIndex + 1;
            document.getElementById('tut-step-tot').innerText = uiTourSteps.length;
            document.getElementById('tut-btn-next').innerText = (uiTourIndex === uiTourSteps.length - 1) ? 
                (currentLang === 'en' ? 'Finish' : 'Fine') : 
                (currentLang === 'en' ? 'Next ‚Üí' : 'Avanti ‚Üí');
            document.querySelector('.tut-skip').innerText = currentLang === 'en' ? 'Skip' : 'Salta';

            // 2. Logica di Posizionamento Avanzata
            if (!step.target) {
                // CASO: Centro Schermo (Step iniziale)
                spotlight.style.width = '0px'; spotlight.style.height = '0px';
                spotlight.style.top = '50%'; spotlight.style.left = '50%';
                spotlight.style.boxShadow = '0 0 0 9999px rgba(0,0,0,0.75)'; // Tutto scuro
                
                // Centra la card
                card.style.top = '50%'; card.style.left = '50%';
                card.style.transform = 'translate(-50%, -50%)';
            } else {
                const targetEl = document.querySelector(step.target);
                if(targetEl) {
                    const rect = targetEl.getBoundingClientRect(); // Posizione elemento target
                    const cardRect = card.getBoundingClientRect(); // Dimensioni della card tutorial
                    const margin = 20; // Distanza dall'elemento
                    
                    // --- Posizionamento Spotlight ---
                    spotlight.style.width = rect.width + 'px';
                    spotlight.style.height = rect.height + 'px';
                    spotlight.style.top = rect.top + 'px';
                    spotlight.style.left = rect.left + 'px';
                    spotlight.style.boxShadow = '0 0 0 9999px rgba(0,0,0,0.75)';

                    // --- Calcolo Posizione Card ---
                    card.style.transform = 'none'; // Rimuovi il translate del centro schermo

                    // 1. Calcolo Orizzontale (Centrato rispetto all'elemento)
                    let leftPos = rect.left + (rect.width / 2) - (300 / 2); // 300 √® la larghezza css della card
                    
                    // CORREZIONE BORDI ORIZZONTALI (Clamp)
                    // Se esce a sinistra, fissalo a 10px dal bordo
                    if (leftPos < 10) leftPos = 10;
                    // Se esce a destra, fissalo a 10px dal bordo destro
                    if (leftPos + 300 > window.innerWidth - 10) {
                        leftPos = window.innerWidth - 320; 
                    }

                    // 2. Calcolo Verticale (Preferenza: SOTTO l'elemento)
                    let topPos = rect.bottom + margin;

                    // CORREZIONE BORDO INFERIORE
                    // Se la card andrebbe fuori dallo schermo in basso...
                    if (topPos + card.offsetHeight > window.innerHeight - 10) {
                        // ...prova a metterla SOPRA l'elemento
                        const positionAbove = rect.top - card.offsetHeight - margin;
                        
                        // Se c'√® spazio sopra (non va fuori schermo in alto), mettila sopra
                        if (positionAbove > 10) {
                            topPos = positionAbove;
                        } else {
                            // Se non c'√® spazio n√© sopra n√© sotto (elemento enorme o schermo piccolo),
                            // mettila in basso a tutto ma dentro lo schermo
                            topPos = window.innerHeight - card.offsetHeight - 10;
                        }
                    }

                    // Applica le coordinate calcolate
                    card.style.left = leftPos + 'px';
                    card.style.top = topPos + 'px';
                }
            }
        }
    // --- FUNZIONE DI RICERCA SICURA ---
        let searchTimer; // Variabile per gestire il ritardo dello scroll

        function runSearch() {
            // 1. Prendi il testo scritto dall'utente
            const inputEl = document.getElementById('search-input');
            if (!inputEl) return; // Sicurezza: se non trova l'input, si ferma
            
            const query = inputEl.value.toLowerCase().trim();
            const viewport = document.getElementById('viewport');

            // 2. Se il campo √® vuoto, resetta tutto come prima
            if (!query) {
                // Rimuove la classe 'dimmed' (sbiadito) da tutto
                document.querySelectorAll('.dimmed').forEach(el => el.classList.remove('dimmed'));
                // Rimuove effetti di ingrandimento
                document.querySelectorAll('.node').forEach(el => {
                    el.style.transform = '';
                    el.style.zIndex = '';
                    el.style.boxShadow = '';
                });
                return;
            }

            // 3. Cerca tra i nodi
            let firstFoundNode = null;
            
            // Loop su tutti i dati (l'array 'data' che contiene tutti gli eventi)
            data.forEach(item => {
                // Trova il nodo fisico HTML corrispondente
                const nodeEl = document.querySelector(`.node[data-id="${item.id}"]`);
                if (!nodeEl) return;

                // Crea una stringa con tutto il testo da cercare (Titolo + Anno + Descrizione)
                // Nota: getTrans √® la tua funzione che sceglie la lingua (en o it)
                const fullText = (
                    getTrans(item.label) + " " + 
                    item.sigla + " " + 
                    item.year + " " + 
                    getTrans(item.desc)
                ).toLowerCase();

                // 4. Verifica se c'√® corrispondenza
                if (fullText.includes(query)) {
                    // TROVATO: Evidenzia
                    nodeEl.classList.remove('dimmed');
                    nodeEl.style.transform = 'scale(1.15)'; // Ingrandisci
                    nodeEl.style.zIndex = '1000'; // Porta sopra
                    nodeEl.style.boxShadow = '0 0 20px var(--c-social)'; // Aloni
                    
                    if (!firstFoundNode) firstFoundNode = nodeEl;
                } else {
                    // NON TROVATO: Sbiadisci
                    nodeEl.classList.add('dimmed');
                    nodeEl.style.transform = '';
                    nodeEl.style.zIndex = '';
                    nodeEl.style.boxShadow = '';
                }
            });

            // Sbiadisci anche le linee e le etichette degli eventi storici per pulizia
            document.querySelectorAll('svg path').forEach(p => p.classList.add('dimmed'));
            document.querySelectorAll('.bg-event-label').forEach(l => l.classList.add('dimmed'));

            // 5. Scroll Automatico al primo risultato
            if (firstFoundNode) {
                clearTimeout(searchTimer);
                searchTimer = setTimeout(() => {
                    // Calcolo per centrare il nodo nello schermo
                    const nodeLeft = parseFloat(firstFoundNode.style.left);
                    const screenCenter = window.innerWidth / 2;
                    const scrollTo = nodeLeft - screenCenter + 35; // 35 √® met√† larghezza nodo
                    
                    viewport.scrollTo({ left: scrollTo, behavior: 'smooth' });
                }, 600); // Aspetta 0.6 secondi prima di muoversi
            }
        }
      // --- LOGICA GRAFICI (STATISTICS PAGE) ---
        
        // Variabili globali per memorizzare i grafici (serve per poterli distruggere e ricreare se cambi pagina)
        let branchChart = null;
        let decadeChart = null;

        // --- LOGICA GRAFICI (CORRETTA PER TRADUZIONE LEGENDA) ---
        function renderCharts() {
            if (typeof Chart === 'undefined') return;

            // 1. ELABORAZIONE DATI
            const branchCounts = { 'Civil': 0, 'Economic': 0, 'Social': 0, 'Women': 0, 'Collective': 0, 'Env': 0 };
            const branchColors = [ '#e53e3e', '#d69e2e', '#3182ce', '#d53f8c', '#dd6b20', '#38a169' ]; 
            const decadeCounts = {};

            // Mappa per tradurre le chiavi interne nelle etichette leggibili
            // Usa le stesse chiavi 'dict' della legenda principale per coerenza
            const branchTranslations = {
                'Civil': dict[currentLang].civil,      // "Civil & Political" / "Civili & Politici"
                'Economic': dict[currentLang].econ,    // "Economic & Social"
                'Social': dict[currentLang].social,    // "Social Rights"
                'Women': dict[currentLang].women,      // "Gender / Women"
                'Collective': dict[currentLang].coll,  // "Collective Rights"
                'Env': dict[currentLang].env           // "Environment"
            };

            data.forEach(d => {
                if (d.class.includes('civil')) branchCounts['Civil']++;
                else if (d.class.includes('econ')) branchCounts['Economic']++;
                else if (d.class.includes('social')) branchCounts['Social']++;
                else if (d.class.includes('women')) branchCounts['Women']++;
                else if (d.class.includes('coll')) branchCounts['Collective']++;
                else if (d.class.includes('env')) branchCounts['Env']++;

                const decade = Math.floor(d.year / 10) * 10; 
                if (!decadeCounts[decade]) decadeCounts[decade] = 0;
                decadeCounts[decade]++;
            });

            const sortedDecades = Object.keys(decadeCounts).sort();
            const decadeValues = sortedDecades.map(k => decadeCounts[k]);

            // 2. GRAFICO CIAMBELLA (BRANCHES)
            const ctx1 = document.getElementById('chart-branches');
            if (ctx1) {
                if (branchChart) branchChart.destroy();

                branchChart = new Chart(ctx1.getContext('2d'), {
                    type: 'doughnut',
                    data: {
                        // QUI √à LA MODIFICA: Usiamo le traduzioni invece delle chiavi grezze
                        labels: Object.keys(branchCounts).map(key => branchTranslations[key]),
                        datasets: [{
                            data: Object.values(branchCounts),
                            backgroundColor: branchColors,
                            borderWidth: 1,
                            borderColor: document.body.classList.contains('dark-mode') ? '#1e293b' : '#ffffff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { 
                                position: 'right',
                                labels: { 
                                    color: '#718096',
                                    font: { family: 'Segoe UI', size: 11 },
                                    boxWidth: 12
                                } 
                            }
                        }
                    }
                });
            }

            // 3. GRAFICO BARRE (DECADES)
            const ctx2 = document.getElementById('chart-decades');
            if (ctx2) {
                if (decadeChart) decadeChart.destroy();

                decadeChart = new Chart(ctx2.getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: sortedDecades.map(d => d + "s"),
                        datasets: [{
                            label: dict[currentLang].chart_label_docs, // Traduzione Label
                            data: decadeValues,
                            backgroundColor: '#3182ce',
                            borderRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: { 
                                beginAtZero: true, 
                                grid: { color: document.body.classList.contains('dark-mode') ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.05)' },
                                ticks: { color: '#718096' } 
                            },
                            x: { 
                                grid: { display: false },
                                ticks: { color: '#718096' } 
                            }
                        },
                        plugins: { legend: { display: false } }
                    }
                });
            }
        }
    </script>
</body>
</html>
